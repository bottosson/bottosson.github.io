<!DOCTYPE html><html domain="github.io" ga-id="UA-184527855-1" lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="default-src 'self' ; object-src 'none' ; script-src 'self' 'sha256-Ky9qZOPnMhQV/s7Fdb9TYAOfU4KtWNqCZaFK8tSzXa0=' https://www.google-analytics.com https://ssl.google-analytics.com ; style-src 'unsafe-inline' ; img-src 'self' data: https://www.google-analytics.com ; connect-src https://www.google-analytics.com" http-equiv="Content-Security-Policy"><link href="/img/favicon/favicon-32x32.png?hash=d763fc1b07" rel="icon" sizes="32x32" type="image/png"><link href="/img/favicon/favicon-16x16.png?hash=ee8f8c9160" rel="icon" sizes="16x16" type="image/png"><link href="/img/favicon/favicon-192x192.png?hash=98293e6f87" rel="icon" sizes="192x192" type="image/png"><link href="/img/favicon/favicon-192x192.png?hash=98293e6f87" rel="icon" sizes="512x512" type="image/png"><link href="/img/favicon/apple-touch-icon.png?hash=624ca04e47" rel="apple-touch-icon" sizes="180x180"><meta content="#FFFFFF" name="theme-color"><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name="robots"><title>sRGB gamut clipping</title><meta content="sRGB gamut clipping" property="og:title"><meta content="sRGB gamut clipping When doing image processing, rendering or converting between RGB color spaces, it is easy to end up with RGB values..." name="description"><meta content="sRGB gamut clipping When doing image processing, rendering or converting between RGB color spaces, it is easy to end up with RGB values..." property="og:description"><meta content="@bjornornorn" name="twitter:site"><meta content="@bjornornorn" name="twitter:creator"><link href="https://bottosson.github.io/posts/gamutclipping/" rel="canonical"><meta content="no-referrer-when-downgrade" name="referrer"><link href="/feed/feed.xml" rel="alternate" type="application/atom+xml" title="Björn Ottosson"><link href="/" rel="preconnect" crossorigin=""><script async="" defer="" src="/js/min.js?hash=b945678541"></script><script async="" defer="" src="https://ssl.google-analytics.com/analytics.js"></script><script csp-hash="sha256-Ky9qZOPnMhQV/s7Fdb9TYAOfU4KtWNqCZaFK8tSzXa0=">if (/Mac OS X/.test(navigator.userAgent))document.documentElement.classList.add('apple')</script><style>.content img{display:block;margin-left:auto;margin-right:auto}main img{content-visibility:auto}header nav{z-index:1}:root{--main-width: calc(100vw - 3em)}@media (min-width:37.5em){:root{--main-width: calc(37.5em - 3em)}}#posts li{margin-bottom:.5em}.anchor-link{fill:#d9d9d9;stroke:none}.anchor-link:active,.anchor-link:hover{fill:#4a4a4a}
/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */
html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}details,main{display:block}h1{font-size:2em;margin:.67em 0}button,hr{overflow:visible}hr{box-sizing:content-box;height:0}code,pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}b,strong{font-weight:bolder}small{font-size:80%}img{border-style:none}button{font-family:inherit;font-size:100%;line-height:1.15;margin:0;text-transform:none}[type=button],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}
/*! bulma.io v0.9.1 | MIT License | github.com/jgthms/bulma */
@-webkit-keyframes spinAround{0%{transform:rotate(0deg)}to{transform:rotate(359deg)}}@keyframes spinAround{0%{transform:rotate(0deg)}to{transform:rotate(359deg)}}.button{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-moz-appearance:none;-webkit-appearance:none;align-items:center;border:1px solid transparent;border-radius:4px;box-shadow:none;display:inline-flex;font-size:1rem;height:2.5em;justify-content:flex-start;line-height:1.5;padding:calc(.5em - 1px) calc(.75em - 1px);position:relative;vertical-align:top}.block:not(:last-child),.content:not(:last-child),.table:not(:last-child),.title:not(:last-child){margin-bottom:1.5rem}.button:active,.button:focus,.is-active.button{outline:0}
/*! minireset.css v0.0.6 | MIT License | github.com/jgthms/minireset.css */
@-webkit-keyframes moveIndeterminate{0%{background-position:200% 0}to{background-position:-200% 0}}@keyframes moveIndeterminate{0%{background-position:200% 0}to{background-position:-200% 0}}blockquote,body,h1,h2,h3,h4,hr,html,li,ol,p,pre,ul{margin:0;padding:0}h1,h2,h3,h4{font-size:100%;font-weight:400}ul{list-style:none}button{margin:0}html{box-sizing:border-box;background-color:#fff;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;min-width:300px;overflow-x:hidden;overflow-y:scroll;text-rendering:optimizeLegibility;-webkit-text-size-adjust:100%;-moz-text-size-adjust:100%;-ms-text-size-adjust:100%;text-size-adjust:100%}*,::after,::before{box-sizing:inherit}img{height:auto;max-width:100%}table{border-collapse:collapse;border-spacing:0}article,header,hr,section{display:block}body,button{font-family:BlinkMacSystemFont,-apple-system,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue","Helvetica","Arial",sans-serif}code,pre{-moz-osx-font-smoothing:auto;-webkit-font-smoothing:auto;font-family:monospace}body,code{font-weight:400}body{color:#4a4a4a;font-size:1em;line-height:1.5}a{color:#3273dc;text-decoration:none}a strong,pre code{color:currentColor}.button,a:hover,strong{color:#363636}code{color:#da1039;padding:.25em .5em}hr{border:0;height:2px;margin:1.5rem 0}code,pre,small{font-size:.875em}span{font-style:inherit;font-weight:inherit}strong{font-weight:700}code,hr,pre{background-color:#f5f5f5}pre{-webkit-overflow-scrolling:touch;color:#4a4a4a;overflow-x:auto;padding:1.25rem 1.5rem;white-space:pre;word-wrap:normal}pre code{background-color:transparent;font-size:1em;padding:0}.button,a{cursor:pointer}.button{background-color:#fff;border-color:#dbdbdb;border-width:1px;justify-content:center;padding-bottom:calc(.5em - 1px);padding-left:1em;padding-right:1em;padding-top:calc(.5em - 1px);text-align:center;white-space:nowrap}.button strong{color:inherit}.button .icon,.button .icon.is-medium,.button .icon.is-small{height:1.5em;width:1.5em}.button .icon:first-child:not(:last-child){margin-left:calc(-.5em - 1px);margin-right:.25em}.button .icon:last-child:not(:first-child){margin-left:.25em;margin-right:calc(-.5em - 1px)}.button .icon:first-child:last-child{margin-left:calc(-.5em - 1px);margin-right:calc(-.5em - 1px)}.button:hover{border-color:#b5b5b5;color:#363636}.button:focus{border-color:#3273dc;color:#363636}.button:focus:not(:active){box-shadow:0 0 0 .125em rgba(50,115,220,.25)}.button.is-active,.button:active{border-color:#4a4a4a;color:#363636}.button.is-white,.button.is-white:hover{background-color:#fff;border-color:transparent;color:#0a0a0a}.button.is-white:hover{background-color:#f9f9f9}.button.is-white:focus{border-color:transparent;color:#0a0a0a}.button.is-white:focus:not(:active){box-shadow:0 0 0 .125em rgba(255,255,255,.25)}.button.is-white.is-active,.button.is-white:active{background-color:#f2f2f2;border-color:transparent;color:#0a0a0a}.button.is-small{border-radius:2px;font-size:.75rem}.button.is-medium{font-size:1.25rem}.buttons{align-items:center;display:flex;flex-wrap:wrap;justify-content:flex-start}.buttons .button{margin-bottom:.5rem}.buttons .button:not(:last-child):not(.is-fullwidth){margin-right:.5rem}.buttons:last-child{margin-bottom:-.5rem}.buttons:not(:last-child){margin-bottom:1rem}.container{flex-grow:1;margin:0 auto;position:relative;width:auto}@media screen and (min-width:1024px){.container{max-width:960px}}@media screen and (min-width:1216px){.container:not(.is-max-desktop){max-width:1152px}}@media screen and (min-width:1408px){.container:not(.is-max-desktop):not(.is-max-widescreen){max-width:1344px}}.content li+li{margin-top:.25em}.content blockquote:not(:last-child),.content ol:not(:last-child),.content p:not(:last-child),.content pre:not(:last-child),.content table:not(:last-child),.content ul:not(:last-child){margin-bottom:1em}.content h1,.content h2,.content h3,.content h4{color:#363636;font-weight:600;line-height:1.125}.content h1{font-size:2em;margin-bottom:.5em}.content h1:not(:first-child){margin-top:1em}.content h2{font-size:1.75em;margin-bottom:.5714em}.content h2:not(:first-child){margin-top:1.1428em}.content h3{font-size:1.5em;margin-bottom:.6666em}.content h3:not(:first-child){margin-top:1.3333em}.content h4{font-size:1.25em;margin-bottom:.8em}.content blockquote{background-color:#f5f5f5;border-left:5px solid #dbdbdb;padding:1.25em 1.5em}.content ol{list-style-position:outside;margin-left:2em;margin-top:1em}.content ol:not([type]){list-style-type:decimal}.content ul{list-style:disc outside;margin-left:2em;margin-top:1em}.content ul ul{list-style-type:circle;margin-top:.5em}.content ul ul ul{list-style-type:square}.content pre{-webkit-overflow-scrolling:touch;overflow-x:auto;padding:1.25em 1.5em;white-space:pre;word-wrap:normal}.content table{width:100%}.content.is-small{font-size:.75rem}.content.is-medium{font-size:1.25rem}.icon{align-items:center;display:inline-flex;justify-content:center;height:1.5rem;width:1.5rem}.icon.is-small{height:1rem;width:1rem}.icon.is-medium{height:2rem;width:2rem}.image{display:block;position:relative}.image img{display:block;height:auto;width:100%}.navbar.is-white,.table{background-color:#fff;color:#363636}.title{word-break:break-word;color:#363636;font-size:2rem;font-weight:600;line-height:1.125}.title em,.title span,.title strong{font-weight:inherit}.title strong{color:inherit}.control{box-sizing:border-box;clear:both;font-size:1rem;position:relative;text-align:inherit}.navbar{background-color:#fff;min-height:3.25rem;position:relative;z-index:30}.navbar.is-white{color:#0a0a0a}.navbar.is-white .navbar-brand>.navbar-item,.navbar.is-white .navbar-burger{color:#0a0a0a}.navbar.is-white .navbar-brand>a.navbar-item.is-active,.navbar.is-white .navbar-brand>a.navbar-item:focus,.navbar.is-white .navbar-brand>a.navbar-item:hover{background-color:#f2f2f2;color:#0a0a0a}@media screen and (min-width:1024px){.navbar.is-white .navbar-end>.navbar-item{color:#0a0a0a}.navbar.is-white .navbar-end>a.navbar-item.is-active,.navbar.is-white .navbar-end>a.navbar-item:focus,.navbar.is-white .navbar-end>a.navbar-item:hover{background-color:#f2f2f2;color:#0a0a0a}}.navbar-brand,.navbar>.container{align-items:stretch;display:flex;min-height:3.25rem}.navbar>.container{width:100%}.navbar.has-shadow{box-shadow:0 2px 0 0 #f5f5f5}.navbar.is-fixed-top{left:0;position:fixed;right:0;z-index:30;top:0}body.has-navbar-fixed-top,html.has-navbar-fixed-top{padding-top:3.25rem}.navbar-brand{flex-shrink:0}.navbar-brand a.navbar-item:focus,.navbar-brand a.navbar-item:hover{background-color:transparent}.navbar-burger{color:#4a4a4a;cursor:pointer;display:block;height:3.25rem;position:relative;width:3.25rem;margin-left:auto}.navbar-burger span{background-color:currentColor;display:block;height:1px;left:calc(50% - 8px);position:absolute;transform-origin:center;transition-duration:86ms;transition-property:background-color,opacity,transform;transition-timing-function:ease-out;width:16px}.navbar-burger span:nth-child(1){top:calc(50% - 6px)}.navbar-burger span:nth-child(2){top:calc(50% - 1px)}.navbar-burger span:nth-child(3){top:calc(50% + 4px)}.navbar-burger:hover{background-color:rgba(0,0,0,.05)}.navbar-burger.is-active span:nth-child(1){transform:translateY(5px) rotate(45deg)}.navbar-burger.is-active span:nth-child(2){opacity:0}.navbar-burger.is-active span:nth-child(3){transform:translateY(-5px) rotate(-45deg)}.navbar-menu{display:none}.navbar-item{color:#4a4a4a;display:block;line-height:1.5;padding:.5rem .75rem;position:relative;flex-grow:0;flex-shrink:0}.navbar-item .icon:only-child{margin-left:-.25rem;margin-right:-.25rem}a.navbar-item{cursor:pointer}a.navbar-item.is-active,a.navbar-item:focus,a.navbar-item:focus-within,a.navbar-item:hover{background-color:#fafafa;color:#3273dc}.navbar-item img{max-height:1.75rem}.navbar-item.is-tab{border-bottom:1px solid transparent;min-height:3.25rem;padding-bottom:calc(.5rem - 1px)}.navbar-item.is-tab:focus,.navbar-item.is-tab:hover{background-color:transparent;border-bottom-color:#3273dc}.navbar-item.is-tab.is-active{background-color:transparent;border-bottom-color:#3273dc;border-bottom-style:solid;border-bottom-width:3px;color:#3273dc;padding-bottom:calc(.5rem - 3px)}@media screen and (max-width:1023px){.navbar>.container{display:block}.navbar-brand .navbar-item{align-items:center;display:flex}.navbar-menu{background-color:#fff;box-shadow:0 8px 16px rgba(10,10,10,.1);padding:.5rem 0}.navbar-menu.is-active{display:block}.navbar.is-fixed-top .navbar-menu{-webkit-overflow-scrolling:touch;max-height:calc(100vh - 3.25rem);overflow:auto}}@media screen and (min-width:1024px){.navbar,.navbar-end,.navbar-menu{align-items:stretch;display:flex}.navbar{min-height:3.25rem}.navbar-burger{display:none}.navbar-item{align-items:center;display:flex}.navbar-menu{flex-grow:1;flex-shrink:0}.navbar-end{justify-content:flex-end;margin-left:auto}.container>.navbar .navbar-brand,.navbar>.container .navbar-brand{margin-left:-.75rem}.container>.navbar .navbar-menu,.navbar>.container .navbar-menu{margin-right:-.75rem}a.navbar-item.is-active{color:#0a0a0a}a.navbar-item.is-active:not(:focus):not(:hover){background-color:transparent}}.column{display:block;flex-basis:0;flex-grow:1;flex-shrink:1;padding:.75rem}@media screen and (min-width:769px),print{.column.is-half{flex:none;width:50%}}.columns{margin-left:-.75rem;margin-right:-.75rem;margin-top:-.75rem}.columns:last-child{margin-bottom:-.75rem}.columns:not(:last-child){margin-bottom:calc(1.5rem - .75rem)}@media screen and (min-width:769px),print{.columns:not(.is-desktop){display:flex}}.has-background-grey-lighter{background-color:#dbdbdb!important}.is-size-3{font-size:2rem!important}.is-size-5{font-size:1.25rem!important}.has-text-weight-semibold{font-weight:600!important}.section{padding:3rem 1.5rem}@media screen and (min-width:1024px){.section.is-medium{padding:9rem 1.5rem}}@font-face{font-family:KaTeX_Main;src:url(/fonts/KaTeX_Main-Bold.eot);src:url(/fonts/KaTeX_Main-Bold.eot#iefix) format('embedded-opentype'),url(/fonts/KaTeX_Main-Bold.woff2) format('woff2'),url(/fonts/KaTeX_Main-Bold.woff) format('woff'),url(/fonts/KaTeX_Main-Bold.ttf) format('ttf');font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Main;src:url(/fonts/KaTeX_Main-Italic.eot);src:url(/fonts/KaTeX_Main-Italic.eot#iefix) format('embedded-opentype'),url(/fonts/KaTeX_Main-Italic.woff2) format('woff2'),url(/fonts/KaTeX_Main-Italic.woff) format('woff'),url(/fonts/KaTeX_Main-Italic.ttf) format('ttf');font-weight:400;font-style:italic}@font-face{font-family:KaTeX_Main;src:url(/fonts/KaTeX_Main-Regular.eot);src:url(/fonts/KaTeX_Main-Regular.eot#iefix) format('embedded-opentype'),url(/fonts/KaTeX_Main-Regular.woff2) format('woff2'),url(/fonts/KaTeX_Main-Regular.woff) format('woff'),url(/fonts/KaTeX_Main-Regular.ttf) format('ttf');font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Math;src:url(/fonts/KaTeX_Math-Italic.eot);src:url(/fonts/KaTeX_Math-Italic.eot#iefix) format('embedded-opentype'),url(/fonts/KaTeX_Math-Italic.woff2) format('woff2'),url(/fonts/KaTeX_Math-Italic.woff) format('woff'),url(/fonts/KaTeX_Math-Italic.ttf) format('ttf');font-weight:400;font-style:italic}@font-face{font-family:KaTeX_Size1;src:url(/fonts/KaTeX_Size1-Regular.eot);src:url(/fonts/KaTeX_Size1-Regular.eot#iefix) format('embedded-opentype'),url(/fonts/KaTeX_Size1-Regular.woff2) format('woff2'),url(/fonts/KaTeX_Size1-Regular.woff) format('woff'),url(/fonts/KaTeX_Size1-Regular.ttf) format('ttf');font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size4;src:url(/fonts/KaTeX_Size4-Regular.eot);src:url(/fonts/KaTeX_Size4-Regular.eot#iefix) format('embedded-opentype'),url(/fonts/KaTeX_Size4-Regular.woff2) format('woff2'),url(/fonts/KaTeX_Size4-Regular.woff) format('woff'),url(/fonts/KaTeX_Size4-Regular.ttf) format('ttf');font-weight:400;font-style:normal}.katex-display{display:block;margin:1em 0;text-align:center}.katex .katex-html,.katex-display>.katex{display:inline-block}.katex{font:400 1.21em KaTeX_Main;line-height:1.2;white-space:nowrap;text-indent:0}.katex .katex-mathml{position:absolute;clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden}.katex .base,.katex .strut{display:inline-block}.katex .mathit{font-family:KaTeX_Math;font-style:italic}.katex .mathbf{font-family:KaTeX_Main;font-weight:700}.katex .textstyle>.mord+.mop{margin-left:.16667em}.katex .textstyle>.mord+.mbin{margin-left:.22222em}.katex .textstyle>.mord+.mrel{margin-left:.27778em}.katex .textstyle>.mop+.mop,.katex .textstyle>.mop+.mord,.katex .textstyle>.mord+.minner{margin-left:.16667em}.katex .textstyle>.mop+.mrel{margin-left:.27778em}.katex .textstyle>.mop+.minner{margin-left:.16667em}.katex .textstyle>.mbin+.minner,.katex .textstyle>.mbin+.mop,.katex .textstyle>.mbin+.mopen,.katex .textstyle>.mbin+.mord{margin-left:.22222em}.katex .textstyle>.mrel+.minner,.katex .textstyle>.mrel+.mop,.katex .textstyle>.mrel+.mopen,.katex .textstyle>.mrel+.mord{margin-left:.27778em}.katex .textstyle>.mclose+.mop{margin-left:.16667em}.katex .textstyle>.mclose+.mbin{margin-left:.22222em}.katex .textstyle>.mclose+.mrel{margin-left:.27778em}.katex .textstyle>.mclose+.minner,.katex .textstyle>.minner+.mop,.katex .textstyle>.minner+.mord,.katex .textstyle>.mpunct+.mclose,.katex .textstyle>.mpunct+.minner,.katex .textstyle>.mpunct+.mop,.katex .textstyle>.mpunct+.mopen,.katex .textstyle>.mpunct+.mord,.katex .textstyle>.mpunct+.mpunct,.katex .textstyle>.mpunct+.mrel{margin-left:.16667em}.katex .textstyle>.minner+.mbin{margin-left:.22222em}.katex .textstyle>.minner+.mrel{margin-left:.27778em}.katex .mclose+.mop,.katex .minner+.mop,.katex .mop+.mop,.katex .mop+.mord,.katex .mord+.mop,.katex .textstyle>.minner+.minner,.katex .textstyle>.minner+.mopen,.katex .textstyle>.minner+.mpunct{margin-left:.16667em}.katex .reset-textstyle.textstyle{font-size:1em}.katex .reset-textstyle.scriptstyle{font-size:.7em}.katex .style-wrap{position:relative}.katex .fontsize-ensurer,.katex .mspace,.katex .sizing,.katex .vlist,.katex .vlist>span>span{display:inline-block}.katex .vlist>span{display:block;height:0;position:relative}.katex .vlist .baseline-fix{display:inline-table;table-layout:fixed}.katex .mfrac>span>span{text-align:center}.katex .mfrac .frac-line{width:100%}.katex .mfrac .frac-line:after,.katex .mfrac .frac-line:before{border-bottom-style:solid;border-bottom-width:1px;content:"";display:block}.katex .mfrac .frac-line:after{border-bottom-width:.04em;margin-top:-1px}.katex .mspace.qquad{width:2em}.katex .sqrt>.sqrt-sign{position:relative}.katex .sqrt .sqrt-line{width:100%}.katex .sqrt .sqrt-line:after,.katex .sqrt .sqrt-line:before{border-bottom-style:solid;border-bottom-width:1px;content:"";display:block}.katex .sqrt .sqrt-line:after{border-bottom-width:.04em;margin-top:-1px}.katex .fontsize-ensurer.reset-size4.size1,.katex .sizing.reset-size4.size1{font-size:.55555556em}.katex .fontsize-ensurer.reset-size4.size4,.katex .sizing.reset-size4.size4{font-size:1em}.katex .fontsize-ensurer.reset-size4.size5,.katex .sizing.reset-size4.size5{font-size:1.11111111em}.katex .fontsize-ensurer.reset-size4.size6,.katex .sizing.reset-size4.size6{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size5.size1,.katex .sizing.reset-size5.size1{font-size:.5em}.katex .fontsize-ensurer.reset-size5.size4,.katex .sizing.reset-size5.size4{font-size:.9em}.katex .fontsize-ensurer.reset-size5.size5,.katex .sizing.reset-size5.size5{font-size:1em}.katex .fontsize-ensurer.reset-size5.size6,.katex .sizing.reset-size5.size6{font-size:1.2em}.katex .delimsizing.size1{font-family:KaTeX_Size1}.katex .delimsizing.mult .delim-size4>span,.katex .delimsizing.size4{font-family:KaTeX_Size4}.katex .nulldelimiter{display:inline-block;width:.12em}.katex .mtable .arraycolsep{display:inline-block}.katex .mtable .col-align-c>.vlist{text-align:center}.katex .mtable .col-align-l>.vlist{text-align:left}.resp-sharing-button__icon{stroke:#fff;fill:none}.resp-sharing-button__icon--solid{fill:#fff;stroke:none}.resp-sharing-button--hackernews:focus,.resp-sharing-button--hackernews:hover{background-color:#fb6200}.resp-sharing-button--facebook{background-color:#3b5998;border-color:#3b5998}.resp-sharing-button--facebook:active,.resp-sharing-button--facebook:hover{background-color:#2d4373;border-color:#2d4373}.resp-sharing-button--twitter{background-color:#55acee;border-color:#55acee}.resp-sharing-button--twitter:active,.resp-sharing-button--twitter:hover{background-color:#2795e9;border-color:#2795e9}.resp-sharing-button--email{background-color:#777;border-color:#777}.resp-sharing-button--email:active,.resp-sharing-button--email:hover{background-color:#5e5e5e;border-color:#5e5e5e}.resp-sharing-button--linkedin{background-color:#0077b5;border-color:#0077b5}.resp-sharing-button--linkedin:active,.resp-sharing-button--linkedin:hover{background-color:#046293;border-color:#046293}.resp-sharing-button--reddit{background-color:#5f99cf;border-color:#5f99cf}.resp-sharing-button--reddit:active,.resp-sharing-button--reddit:hover{background-color:#3a80c1;border-color:#3a80c1}.resp-sharing-button--hackernews{background-color:#f60;border-color:#f60}.resp-sharing-button--hackernews:hover .resp-sharing-button--hackernews:active{background-color:#fb6200;border-color:#fb6200}code[class*=language-],pre[class*=language-]{color:#5c6e74;font-size:13px;text-shadow:none;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::mozselection,code[class*=language-]::selection,pre[class*=language-]::mozselection,pre[class*=language-]::selection{text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}.token.comment{color:#93a1a1}.token.punctuation{color:#999}.token.constant,.token.number,.token.property{color:#905}.token.inserted{color:#690}.token.operator,.token.url{color:#a67f59}.token.keyword{color:#07a}.token.function{color:#dd4a68}.token.bold{font-weight:700}pre[class*=language-]>code[class*=language-]{position:relative;z-index:1}</style></head><body class="has-navbar-fixed-top"><header class="container is-max-desktop"><nav class="has-shadow is-fixed-top navbar"><div class="container"><div class="navbar-brand"><a href="/" class="navbar-item has-text-weight-semibold is-size-3">Björn Ottosson </a><a class="navbar-burger" data-target="navMenu" role="button"><span></span> <span></span> <span></span></a></div><div class="navbar-menu" id="navMenu"><div class="is-active navbar-end"><a href="/" class="navbar-item has-text-weight-semibold is-size-5 is-tab">Blog </a><a href="/about/" class="navbar-item has-text-weight-semibold is-size-5 is-tab">About</a><div class="navbar-item"><div class="buttons"><a href="https://twitter.com/bjornornorn" class="is-small button is-white" rel="noopener" target="_blank"><span class="icon"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" height="24" width="24" role="img"><title>Twitter icon</title><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z" style="fill:hsl(0, 0%, 29%)"></path></svg> </span></a><a href="https://www.linkedin.com/in/bjorn-ottosson" class="is-small button is-white" rel="noopener" target="_blank"><span class="icon"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" height="24" width="24" role="img"><title>LinkedIn icon</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" style="fill:hsl(0, 0%, 29%)"></path></svg></span></a></div></div></div></div></div></nav></header><main class="container is-max-desktop"><article class="section"><div class="content is-medium"><h1 id="srgb-gamut-clipping">sRGB gamut clipping <a href="#srgb-gamut-clipping" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h1><p>When doing image processing, rendering or converting between RGB color spaces, it is easy to end up with RGB values outside of the 0.0 to 1.0 range (or 0 to 255 for 8-bit colors). This normally means that it isn’t possible to encode the color and it needs to be adjusted somehow before being displayed or encoded (<a href="https://en.wikipedia.org/wiki/ScRGB">scRGB</a> is an example of an exception, and has a different range). The range of supported colors in a color spaces is referred to as a its <em>gamut</em>.</p><p>Many of the colors outside the gamut are still valid colors, they just can’t be encoded in the given color space. The colors that can’t be encoded can be categorized as follows (for RGB color spaces without <a href="https://en.wikipedia.org/wiki/Impossible_color#Imaginary_colors">imaginary primaries</a>):</p><ul><li><strong>One or more RGB values are larger than one, but none are negative</strong><br>These colors are too bright for the color space, but could be encoded at a lower luminance.</li><li><strong>One or more negative values</strong><br>These color are more colorful than the color space is able to encode. Some of these can be real colors, but they can also be colors more colorful than physically possible. This is a consequence of linear encoding of colors, which is able to encode colors that can’t exist in real life.</li></ul><p>The simplest technique for dealing with colors outside the valid range is to simply clamp <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit" style="margin-right:0.00773em;">R</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit">G</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span> individually. The simplicity of this makes the technique widespread, but unfortunately it has significant drawbacks and can lead to unpleasant color distortions.</p><p>Here is an example of taking a photo and increasing its exposure and colorfulness significantly, with results displayed as sRGB. Colorfulness has been increased by scaling <a href="https://bottosson.github.io/posts/oklab/">Oklab</a> chroma. RGB values here are simply clamped to the 0.0 to 1.0 range.</p><br><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/flowers/original.jpg"><img alt="Original" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/original.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Unprocessed</em></p></div><div class="column"><p><a href="/img/gamutclipping/flowers/clipped_rgb.jpg"><img alt="Processed" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/clipped_rgb.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Processed with out of range values clamped</em></p></div></div><br><p>This is of course problematic. Hues are heavily distorted and all the details in the flowers are gone. Better methods are needed. Thankfully, this problem isn’t new and has been researched a lot over the years.</p><p>Two main research topics exist:</p><blockquote><p><strong><a href="https://en.wikipedia.org/wiki/Tone_mapping">Tone mapping</a></strong>, which is concerned with mapping high dynamic range images to a lower dynamic range. This typically involves altering both colors inside and outside the gamut and sometimes involves different kinds of spatial filtering to keep details while reducing overall dynamic range.</p><p><strong><a href="https://en.wikipedia.org/wiki/Color_management#Gamut_mapping">Gamut mapping</a></strong>, which is concerned with mapping colors from one color space to another and dealing with the mismatch in what colors can be encoded. This can either be done using <em>gamut compression</em> or <em>gamut expansion</em>, which adjusts all colors of an image, or using <em>gamut clipping</em>, which leaves colors that exist in both color spaces intact, while mapping colors outside the gamut back in range. For an overview see the paper <a href="https://www.researchgate.net/publication/236121201_The_Fundamentals_of_Gamut_Mapping_A_Survey">“The Fundamentals of Gamut Mapping: A Survey”</a>.</p></blockquote><p>Tone mapping, gamut expansion and gamut compression are all useful techniques, but will not be the focus of this article. Instead we will limit the scope to creating a practical alternative to clipping sRGB values, by looking at gamut clipping in the sRGB color space and on relatively simple, robust and portable algorithms. The source code for the operations shown is also available, at the <a href="#source-code">end of the article</a>.</p><p>The techniques investigated are also, with some additional work, applicable to other color spaces, and some of the building blocks can be for other things, such as gamut compression. Combining gamut clipping with tone mapping can also be useful since some tone mapping techniques may still produce colors outside the target gamut.</p><h2 id="gamut-clipping">Gamut Clipping <a href="#gamut-clipping" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h2><p>The goal of gamut clipping is to take colors that are outside the target gamut, and map them back to valid colors in a way that avoids perceived distortion and artifacts. In this article we also want to do this in a way that is reasonably efficient and simple to implement. Many techniques require complex iterative algorithms per pixel (or storing the results in 3D lookup tables) – those will not be considered here, but can be useful for many applications.</p><p>Instead we will take this commonly used approach:</p><ul><li>Work in a perceptual color space.</li><li>Keep hue constant, only change lightness and chroma.</li><li>Only project color along straight lines in the perceptual color space.</li></ul><p>For an overview of different approaches, see the paper <a href="https://www.researchgate.net/publication/236121201_The_Fundamentals_of_Gamut_Mapping_A_Survey">The Fundamentals of Gamut Mapping: A Survey</a>.</p><p>As a color space, we will use the <a href="https://bottosson.github.io/posts/oklab/">Oklab</a> perceptual color space, since it models hue, chroma and lightness well while being easy to work with mathematically. In particular, with Oklab, the shape of the gamut of an RGB color space is described by cubic polynomials, which are quite practical to work with compared to the equations you get with other spaces.</p><p>Since we have decided to keep hue constant, it is now possible to plot the problem in two dimensions, using lightness, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit">L</span></span></span></span>, and chroma, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span>. To better understand the shape of the sRGB gamut, let’s look at of slices of constant hue. These are sampled every 30 degrees:</p><br><div class="columns has-background-grey-lighter"><div class="column"><p><img alt="0" decoding="async" height="210" loading="lazy" src="/img/gamutclipping/hueslices/0.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 212px) min(calc(var(--main-width) * 0.9905660377358491), 210px);" width="212"></p></div><div class="column"><p><img alt="30" decoding="async" height="210" loading="lazy" src="/img/gamutclipping/hueslices/30.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 212px) min(calc(var(--main-width) * 0.9905660377358491), 210px);" width="212"></p></div><div class="column"><p><img alt="60" decoding="async" height="210" loading="lazy" src="/img/gamutclipping/hueslices/60.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 212px) min(calc(var(--main-width) * 0.9905660377358491), 210px);" width="212"></p></div><div class="column"><p><img alt="90" decoding="async" height="210" loading="lazy" src="/img/gamutclipping/hueslices/90.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 212px) min(calc(var(--main-width) * 0.9905660377358491), 210px);" width="212"></p></div></div><div class="columns has-background-grey-lighter"><div class="column"><p><img alt="120" decoding="async" height="210" loading="lazy" src="/img/gamutclipping/hueslices/120.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 212px) min(calc(var(--main-width) * 0.9905660377358491), 210px);" width="212"></p></div><div class="column"><p><img alt="150" decoding="async" height="210" loading="lazy" src="/img/gamutclipping/hueslices/150.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 212px) min(calc(var(--main-width) * 0.9905660377358491), 210px);" width="212"></p></div><div class="column"><p><img alt="180" decoding="async" height="210" loading="lazy" src="/img/gamutclipping/hueslices/180.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 212px) min(calc(var(--main-width) * 0.9905660377358491), 210px);" width="212"></p></div><div class="column"><p><img alt="210" decoding="async" height="210" loading="lazy" src="/img/gamutclipping/hueslices/210.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 212px) min(calc(var(--main-width) * 0.9905660377358491), 210px);" width="212"></p></div></div><div class="columns has-background-grey-lighter"><div class="column"><p><img alt="240" decoding="async" height="210" loading="lazy" src="/img/gamutclipping/hueslices/240.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 212px) min(calc(var(--main-width) * 0.9905660377358491), 210px);" width="212"></p></div><div class="column"><p><img alt="270" decoding="async" height="210" loading="lazy" src="/img/gamutclipping/hueslices/270.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 212px) min(calc(var(--main-width) * 0.9905660377358491), 210px);" width="212"></p></div><div class="column"><p><img alt="300" decoding="async" height="210" loading="lazy" src="/img/gamutclipping/hueslices/300.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 212px) min(calc(var(--main-width) * 0.9905660377358491), 210px);" width="212"></p></div><div class="column"><p><img alt="330" decoding="async" height="210" loading="lazy" src="/img/gamutclipping/hueslices/330.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 212px) min(calc(var(--main-width) * 0.9905660377358491), 210px);" width="212"></p></div></div><br><p>Our goal is to find a way to map colors outside the gamut, shown in grey in the graphs, back into the gamut using straight lines. This problem can be split into two parts:</p><ol><li>Deciding along which line to project the color onto the gamut</li><li>Finding the intersection between the line and the gamut</li></ol><p>Lets start by tackling part 2.</p><h2 id="intersecting-lines-with-the-gamut">Intersecting lines with the gamut <a href="#intersecting-lines-with-the-gamut" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h2><p>The math here is quite involved, so this sections just contains an overview of the approach. If that is still too much math, <a href="#choosing-which-line-to-project-along">skip to the next section</a>. For more details, see the source code.</p><p>Expressed mathematically, the problem we want to solve is: Given a color expressed as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>L</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>1</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(L_1, C_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="uncramped textstyle base"><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>, and a point <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>L</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>0</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(L_0, C_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="uncramped textstyle base"><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span> that is known to be inside the gamut, we want to find a value <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.61508em;"></span><span class="strut bottom" style="height:0.61508em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit">t</span></span></span></span> so that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>L</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>C</mi><mi>t</mi></msub><mo>)</mo><mo>=</mo><mi>t</mi><mo>(</mo><msub><mi>L</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>1</mn></msub><mo>)</mo><mo>+</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>t</mi><mo>)</mo><mo>(</mo><msub><mi>L</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>0</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(L_t, C_t) = t (L_1, C_1) + (1-t) (L_0, C_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="uncramped textstyle base"><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord mathit">t</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span> is a point on the gamut surface. We will also set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">C_0=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> since the projections we want to make later always pass through the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit">L</span></span></span></span> axis.</p><p>Using the definition of Oklab <a href="https://bottosson.github.io/posts/oklab/">here</a>, we get this conversion from <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>C</mi><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">LCh^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit">L</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> to linear <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>R</mi><mi>G</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">sRGB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">G</span><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span>:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><msup><mi>l</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>m</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>s</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>=</mo><msup><mrow><msub><mi mathvariant="bold">M</mi><mn mathvariant="bold">2</mn></msub></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>×</mo><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><mi>L</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>C</mi><mi>cos</mi><mo>(</mo><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi>C</mi><mi>sin</mi><mo>(</mo><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>)</mo></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mspace width="2em"></mspace><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><mi>l</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>m</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>s</mi></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>=</mo><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><msup><mrow><mo>(</mo><msup><mi>l</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>)</mo></mrow><mrow><mn>3</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow><msup><mrow><mo>(</mo><msup><mi>m</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>)</mo></mrow><mrow><mn>3</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow><msup><mrow><mo>(</mo><msup><mi>s</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>)</mo></mrow><mrow><mn>3</mn></mrow></msup></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mspace width="2em"></mspace><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><mi>r</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>g</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>b</mi></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>=</mo><msub><mrow><mi mathvariant="bold">M</mi></mrow><mrow><mi>X</mi><mi>Y</mi><mi>Z</mi><mi mathvariant="normal">_</mi><mi>t</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>R</mi><mi>G</mi><mi>B</mi></mrow></msub><msup><mrow><msub><mi mathvariant="bold">M</mi><mn mathvariant="bold">1</mn></msub></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>×</mo><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><mi>l</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>m</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>s</mi></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{pmatrix} l' \\ m' \\ s' \end{pmatrix} = \mathbf{M_2}^{-1} \times \begin{pmatrix} L \\ C\cos(h^{\circ}) \\ C\sin(h^{\circ}) \end{pmatrix},\qquad \begin{pmatrix} l \\ m \\ s \end{pmatrix} = \begin{pmatrix} {(l')}^{3} \\ {(m')}^{3} \\ {(s')}^{3} \end{pmatrix},\qquad \begin{pmatrix} r \\ g \\ b \end{pmatrix} = \mathbf{M}_{XYZ\_to\_sRGB} \mathbf{M_1}^{-1} \times \begin{pmatrix} l \\ m \\ s \end{pmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.0905em;"></span><span class="strut bottom" style="height:3.681em;vertical-align:-1.5905000000000002em;"></span><span class="uncramped textstyle base displaystyle"><span class="uncramped textstyle displaystyle minner"><span class="uncramped textstyle reset-textstyle style-wrap"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎝</span></span></span><span style="top:-0.89502em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎛</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span style="top:-0.00999999999999951em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord"><span class="mord mathit">m</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span style="top:1.1900000000000006em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="uncramped textstyle reset-textstyle style-wrap"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎠</span></span></span><span style="top:-0.89502em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎞</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="mrel">=</span><span class=""><span class="mord uncramped textstyle displaystyle"><span class="mord"><span class="mord mathbf">M</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathbf">2</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="uncramped textstyle displaystyle minner"><span class="uncramped textstyle reset-textstyle style-wrap"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎝</span></span></span><span style="top:-0.89502em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎛</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord mathit">L</span></span></span><span style="top:-0.00999999999999951em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mop">cos</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span><span style="top:1.1900000000000006em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mop">sin</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="uncramped textstyle reset-textstyle style-wrap"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎠</span></span></span><span style="top:-0.89502em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎞</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="mpunct">,</span><span class="mord mspace qquad"></span><span class="uncramped textstyle displaystyle minner"><span class="uncramped textstyle reset-textstyle style-wrap"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎝</span></span></span><span style="top:-0.89502em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎛</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span><span style="top:-0.00999999999999951em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord mathit">m</span></span></span><span style="top:1.1900000000000006em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="uncramped textstyle reset-textstyle style-wrap"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎠</span></span></span><span style="top:-0.89502em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎞</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="mrel">=</span><span class="uncramped textstyle displaystyle minner"><span class="uncramped textstyle reset-textstyle style-wrap"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎝</span></span></span><span style="top:-0.89502em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎛</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.2235em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord"><span class="mord uncramped textstyle displaystyle"><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span><span class="vlist"><span style="top:-0.41589200000000004em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span style="top:0.0035000000000005582em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord"><span class="mord uncramped textstyle displaystyle"><span class="mopen">(</span><span class="mord"><span class="mord mathit">m</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span><span class="vlist"><span style="top:-0.41589200000000004em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span style="top:1.2305000000000001em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord"><span class="mord uncramped textstyle displaystyle"><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span><span class="vlist"><span style="top:-0.41589200000000004em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="uncramped textstyle reset-textstyle style-wrap"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎠</span></span></span><span style="top:-0.89502em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎞</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="mpunct">,</span><span class="mord mspace qquad"></span><span class="uncramped textstyle displaystyle minner"><span class="uncramped textstyle reset-textstyle style-wrap"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎝</span></span></span><span style="top:-0.89502em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎛</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span><span style="top:-0.00999999999999951em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span><span style="top:1.1900000000000006em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord mathit">b</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="uncramped textstyle reset-textstyle style-wrap"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎠</span></span></span><span style="top:-0.89502em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎞</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="mrel">=</span><span class=""><span class="mord uncramped textstyle displaystyle"><span class="mord mathbf">M</span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord mathit" style="margin-right:0.22222em;">Y</span><span class="mord mathit" style="margin-right:0.07153em;">Z</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">t</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">G</span><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class=""><span class="mord uncramped textstyle displaystyle"><span class="mord"><span class="mord mathbf">M</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathbf">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="uncramped textstyle displaystyle minner"><span class="uncramped textstyle reset-textstyle style-wrap"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎝</span></span></span><span style="top:-0.89502em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎛</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span><span style="top:-0.00999999999999951em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord mathit">m</span></span></span><span style="top:1.1900000000000006em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="uncramped textstyle reset-textstyle style-wrap"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎠</span></span></span><span style="top:-0.89502em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="delim-size4 delimsizinginner"><span>⎞</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></span></p><p>The gamut is then defined by the following inequalities:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>r</mi><mo>&lt;</mo><mn>1</mn><mo separator="true">,</mo><mspace width="2em"></mspace><mn>0</mn><mo>&lt;</mo><mi>g</mi><mo>&lt;</mo><mn>1</mn><mo separator="true">,</mo><mspace width="2em"></mspace><mn>0</mn><mo>&lt;</mo><mi>b</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; r &lt; 1,\qquad 0 &lt; g &lt; 1,\qquad 0 &lt; b &lt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="uncramped textstyle base displaystyle"><span class="mord mathrm">0</span><span class="mrel">&lt;</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mrel">&lt;</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mspace qquad"></span><span class="mord mathrm">0</span><span class="mrel">&lt;</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">&lt;</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mspace qquad"></span><span class="mord mathrm">0</span><span class="mrel">&lt;</span><span class="mord mathit">b</span><span class="mrel">&lt;</span><span class="mord mathrm">1</span></span></span></span></span></p><p>This is enough information to solve the problem numerically, but involves solving six cubic polynomials. We are after a faster solution that uses more knowledge about the problem.</p><p>By studying the gamut graphs and the equations, we can draw a few conclusions:</p><ul><li>For a given hue, the lower limit is always a straight line passing through <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">(0,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="uncramped textstyle base"><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span></span></span></span></li><li>The gamut shape is always close to a triangle, with two of its corners in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">(1,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="uncramped textstyle base"><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">(0,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="uncramped textstyle base"><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span></span></span></span></li><li>If we can find the third point, we know exactly the lower limit and we have good first approximation of the upper limit</li></ul><p>The location of the third point, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">(L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="uncramped textstyle base"><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">C_{cusp})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>, only depends on <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>. To find it we use a fitted numerical approximation followed by a single step of <a href="https://en.wikipedia.org/wiki/Halley%27s_method">Halley’s method</a>, this gives an error less than <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mi>e</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">10e6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathit">e</span><span class="mord mathrm">6</span></span></span></span> (except for one point where the derivative <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub><mi mathvariant="normal">/</mi><mi mathvariant="normal">∂</mi><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\partial C_{cusp}/\partial h^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="uncramped textstyle base"><span class="mord mathrm" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">/</span><span class="mord mathrm" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> is close to infinite). Since this only depends on <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> it is also possible to use a 1D lookup table for it.</p><p>With the location for the cusp, it is now possible to find the intersection with the triangle. If the intersection is with the lower edge, this is everything we need to do. If the intersection is with the upper half, the triangle is only an approximation and we need to refine the solution. Again, one step of Halley’s method is enough to do this with high accuracy.</p><p>Altogether, this is everything needed to find the intersection between a line and the sRGB gamut. To derive the numerical approximation of the location of the cusp, this <a href="https://colab.research.google.com/drive/1JdXHhEyjjEE--19ZPH1bZV_LiGQBndzs?usp=sharing">Google Colab Notebook</a> was used. With same method is should be possible derive approximations for other RGB color spaces. The complete source code is available at the <a href="#source-code">end of this article</a>.</p><h2 id="choosing-which-line-to-project-along">Choosing which line to project along <a href="#choosing-which-line-to-project-along" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h2><p>Starting with a point <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>L</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>1</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(L_1, C_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="uncramped textstyle base"><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>, we want to decide a point <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>L</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>0</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(L_0, C_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="uncramped textstyle base"><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span> within the gamut to project towards. The choice is a matter of preference and can depend on context.</p><p>Let’s start by testing a few simple existing methods and see what the projections look like for different hue slices and when applied the test image from the beginning.</p><h4 id="keep-lightness-constant%2C-only-compress-chroma">Keep lightness constant, only compress chroma <a href="#keep-lightness-constant%2C-only-compress-chroma" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h4><p>Lightness is kept constant if it is between zero and one, otherwise it is clamped. This is done by projecting towards <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>L</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>0</mn></msub><mo>)</mo><mo>=</mo><mo>(</mo><mi>c</mi><mi>l</mi><mi>a</mi><mi>m</mi><mi>p</mi><mo>(</mo><msub><mi>L</mi><mn>1</mn></msub><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo>)</mo><mo separator="true">,</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">(L_0, C_0) = (clamp(L_1, 0, 1), 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="uncramped textstyle base"><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit">c</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">a</span><span class="mord mathit">m</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span></span></span></span></p><br><div class="columns has-background-grey-lighter"><div class="column"><p><img alt="30" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/redslices/clipped_chroma.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>3</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=30^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">3</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column"><p><img alt="120" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/yellowgreenslices/clipped_chroma.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>1</mn><mn>2</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=120^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">2</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column is-half"><p><a href="/img/gamutclipping/flowers/clipped_chroma.jpg"><img alt="flowers" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/clipped_chroma.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Gamut clipping test</em></p></div></div><br><h4 id="projection-towards-a-single-point%2C-hue-independent">Projection towards a single point, hue independent <a href="#projection-towards-a-single-point%2C-hue-independent" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h4><p>Colors are projected towards the middle of the valid greyscale colors: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>L</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>0</mn></msub><mo>)</mo><mo>=</mo><mo>(</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mo separator="true">,</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">(L_0, C_0) = (0.5, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="uncramped textstyle base"><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span></span></span></span></p><br><div class="columns has-background-grey-lighter"><div class="column"><p><img alt="30" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/redslices/sp_middle_grey.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>3</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=30^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">3</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column"><p><img alt="120" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/yellowgreenslices/sp_middle_grey.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>1</mn><mn>2</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=120^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">2</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column is-half"><p><a href="/img/gamutclipping/flowers/sp_middle_grey.jpg"><img alt="flowers" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/sp_middle_grey.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Gamut clipping test</em></p></div></div><br><h4 id="projection-towards-a-single-point%2C-hue-dependent">Projection towards a single point, hue dependent <a href="#projection-towards-a-single-point%2C-hue-dependent" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h4><p>Colors are projected towards the lightness of the cusp of the gamut for the current hue: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>L</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>0</mn></msub><mo>)</mo><mo>=</mo><mo>(</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub><mo separator="true">,</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">(L_0, C_0) = (L_{cusp}, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="uncramped textstyle base"><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span></span></span></span></p><br><div class="columns has-background-grey-lighter"><div class="column"><p><img alt="30" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/redslices/sp_L_cusp.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>3</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=30^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">3</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column"><p><img alt="120" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/yellowgreenslices/sp_L_cusp.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>1</mn><mn>2</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=120^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">2</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column is-half"><p><a href="/img/gamutclipping/flowers/sp_L_cusp.jpg"><img alt="flowers" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/sp_L_cusp.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Gamut clipping test</em></p></div></div><br><h4 id="can-we-do-better%3F">Can we do better? <a href="#can-we-do-better%3F" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h4><p>The choice of projection will always be a matter of preference. Overall I think preserving lightness does the best overall of the above methods (and others agree, it is a commonly used technique). One challenge with preserving lightness though is that all colors with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">L&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="uncramped textstyle base"><span class="mord mathit">L</span><span class="mrel">&gt;</span><span class="mord mathrm">1</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L&lt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="uncramped textstyle base"><span class="mord mathit">L</span><span class="mrel">&lt;</span><span class="mord mathrm">0</span></span></span></span> get projected to a single point, and that highly saturated colors can become almost completely desaturated if light or dark enough, even though sacrificing just a small amount of lightness would have resulted in a much closer match.</p><p>For this reason I’ve looked into creating new methods that mostly preserve lightness, but behaves closer to the single point projection methods for high and low lightness colors. The result is two new methods. They are novel as far as I am aware, but there are a lot of gamut mapping papers I haven’t read.</p><p>The first methiod is based on projection towards <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mo separator="true">,</mo><mi>C</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L=0.5, C=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="uncramped textstyle base"><span class="mord mathit">L</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> and the second based on <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub><mo separator="true">,</mo><mi>C</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L=L_{cusp}, C=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="uncramped textstyle base"><span class="mord mathit">L</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>. Both have a parameter <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span> to control to what extent lightness is preserved. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span> is a real number larger than 0, where values close to zero will behave as pure chroma compression, and larger values will behave closer to the single point projection methods. Here is an overview of the two methods:</p><h4 id="adaptive-%2C-hue-independent">Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">L_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>, hue independent <a href="#adaptive-%2C-hue-independent" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h4><p>This method blends between pure chroma compression and projection towards a single point, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mo separator="true">,</mo><msub><mi>C</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_0=0.5, C_0=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>.</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">L_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> is computed with the following equations:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mi>d</mi></msub><mo>=</mo><msub><mi>L</mi><mn>1</mn></msub><mo>−</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mrow><annotation encoding="application/x-tex">L_d = L_1-0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="uncramped textstyle base displaystyle"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn><mo>+</mo><mi mathvariant="normal">∣</mi><msub><mi>L</mi><mi>d</mi></msub><mi mathvariant="normal">∣</mi><mo>+</mo><mi>α</mi><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">e_1 = 1/2 + |L_d| + \alpha C_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="uncramped textstyle base displaystyle"><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">/</span><span class="mord mathrm">2</span><span class="mbin">+</span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">∣</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mfrac><mrow><mn>1</mn><mo>+</mo><mi>s</mi><mi>g</mi><mi>n</mi><mo>(</mo><msub><mi>L</mi><mi>d</mi></msub><mo>)</mo><mo>(</mo><msub><mi>e</mi><mn>1</mn></msub><mo>−</mo><msqrt><mrow><msubsup><mi>e</mi><mn>1</mn><mn>2</mn></msubsup><mo>−</mo><mn>2</mn><mi mathvariant="normal">∣</mi><msub><mi>L</mi><mi>d</mi></msub><mi mathvariant="normal">∣</mi></mrow></msqrt><mo>)</mo></mrow><mn>2</mn></mfrac><mo separator="true">,</mo><mspace width="2em"></mspace><msub><mi>C</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_0 = \frac{1 + sgn(L_d)(e_1 - \sqrt{e_1^2 - 2 |L_d|})} 2 ,\qquad C_0 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.63001em;"></span><span class="strut bottom" style="height:2.31601em;vertical-align:-0.686em;"></span><span class="uncramped textstyle base displaystyle"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord uncramped textstyle displaystyle reset-textstyle"><span class="size5 reset-size5 nulldelimiter reset-textstyle sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord mathrm">2</span></span></span><span style="top:-0.22999999999999998em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:1em;">​</span></span><span class="uncramped textstyle reset-textstyle frac-line"></span></span><span style="top:-0.680205em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:1em;">​</span></span><span class="uncramped textstyle reset-textstyle"><span class="mord uncramped textstyle"><span class="mord mathrm">1</span><span class="mbin">+</span><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord sqrt"><span class="sqrt-sign" style="top:-0.05980500000000011em;"><span class="uncramped textstyle reset-textstyle style-wrap"><span class="delimsizing size1">√</span></span></span><span class="vlist"><span style="top:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.26630799999999993em;margin-left:0em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span style="top:-0.34480000000000005em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathrm">2</span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">∣</span></span></span><span style="top:-0.869805em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:1em;">​</span></span><span class="uncramped textstyle reset-textstyle sqrt-line"></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="size5 reset-size5 nulldelimiter reset-textstyle sizing textstyle uncramped"></span></span><span class="mpunct">,</span><span class="mord mspace qquad"></span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span></span></p><p>Here are some results with different values for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span>:</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\large \alpha = 0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.773328em;"></span><span class="strut bottom" style="height:0.773328em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size6"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">5</span></span></span></span></span></span></p><div class="columns has-background-grey-lighter"><div class="column"><p><img alt="30" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/redslices/adaptive_middle_grey_0_05.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>3</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=30^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">3</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column"><p><img alt="120" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/yellowgreenslices/adaptive_middle_grey_0_05.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>1</mn><mn>2</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=120^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">2</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column is-half"><p><a href="/img/gamutclipping/flowers/adaptive_middle_grey_0_05.jpg"><img alt="flowers" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/adaptive_middle_grey_0_05.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Gamut clipping test</em></p></div></div><p>\large <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></p><div class="columns has-background-grey-lighter"><div class="column"><p><img alt="30" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/redslices/adaptive_middle_grey_0_50.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>3</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=30^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">3</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column"><p><img alt="120" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/yellowgreenslices/adaptive_middle_grey_0_50.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>1</mn><mn>2</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=120^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">2</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column is-half"><p><a href="/img/gamutclipping/flowers/adaptive_middle_grey_0_50.jpg"><img alt="flowers" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/adaptive_middle_grey_0_50.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Gamut clipping test</em></p></div></div><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\large \alpha = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.773328em;"></span><span class="strut bottom" style="height:0.773328em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size6"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span></p><div class="columns has-background-grey-lighter"><div class="column"><p><img alt="30" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/redslices/adaptive_middle_grey_5_00.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>3</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=30^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">3</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column"><p><img alt="120" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/yellowgreenslices/adaptive_middle_grey_5_00.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>1</mn><mn>2</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=120^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">2</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column is-half"><p><a href="/img/gamutclipping/flowers/adaptive_middle_grey_5_00.jpg"><img alt="flowers" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/adaptive_middle_grey_5_00.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Gamut clipping test</em></p></div></div><br><h4 id="adaptive-%2C-hue-dependent">Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">L_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>, hue dependent <a href="#adaptive-%2C-hue-dependent" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h4><p>This method blends between pure chroma compression and projection towards a single point, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_0=L_{cusp}, C_0=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">L_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> is computed with the following equations:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mi>d</mi></msub><mo>=</mo><msub><mi>L</mi><mn>1</mn></msub><mo>−</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_d = L_1-L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="uncramped textstyle base displaystyle"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>=</mo><mn>2</mn><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>(</mo><mn>1</mn><mo>−</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub><mo>)</mo></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext>&nbsp;</mtext></mtext><msub><mi>L</mi><mi>d</mi></msub><mo>&gt;</mo><mo>=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext>&nbsp;</mtext></mtext><msub><mi>L</mi><mi>d</mi></msub><mo>&lt;</mo><mn>0</mn></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">k = 2 \begin{cases} (1-L_{cusp}) &amp;\text{if } L_d &gt;= 0 \\ L_{cusp} &amp;\text{if } L_d &lt; 0 \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.75em;"></span><span class="strut bottom" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="uncramped textstyle base displaystyle"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">2</span><span class="uncramped textstyle displaystyle minner"><span class="uncramped textstyle reset-textstyle style-wrap" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span><span style="top:0.7579999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord uncramped textstyle displaystyle text"><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mspace">&nbsp;</span></span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">&gt;</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span><span style="top:0.7579999999999999em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="mord uncramped textstyle displaystyle"><span class="mord uncramped textstyle displaystyle text"><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mspace">&nbsp;</span></span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">&lt;</span><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="size5 reset-size5 nulldelimiter reset-textstyle sizing textstyle uncramped"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>=</mo><mfrac><mi>k</mi><mn>2</mn></mfrac><mo>+</mo><mi mathvariant="normal">∣</mi><msub><mi>L</mi><mi>d</mi></msub><mi mathvariant="normal">∣</mi><mo>+</mo><mfrac><mrow><mi>α</mi><msub><mi>C</mi><mn>1</mn></msub></mrow><mi>k</mi></mfrac></mrow><annotation encoding="application/x-tex">e_1 = \frac k 2 + |L_d| + \frac {\alpha C_1} k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="uncramped textstyle base displaystyle"><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord uncramped textstyle displaystyle reset-textstyle"><span class="size5 reset-size5 nulldelimiter reset-textstyle sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord mathrm">2</span></span></span><span style="top:-0.22999999999999998em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped textstyle reset-textstyle frac-line"></span></span><span style="top:-0.677em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped textstyle reset-textstyle"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="size5 reset-size5 nulldelimiter reset-textstyle sizing textstyle uncramped"></span></span><span class="mbin">+</span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">∣</span><span class="mbin">+</span><span class="mord uncramped textstyle displaystyle reset-textstyle"><span class="size5 reset-size5 nulldelimiter reset-textstyle sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span style="top:-0.22999999999999998em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped textstyle reset-textstyle frac-line"></span></span><span style="top:-0.677em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped textstyle reset-textstyle"><span class="mord uncramped textstyle"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="size5 reset-size5 nulldelimiter reset-textstyle sizing textstyle uncramped"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub><mo>+</mo><mfrac><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo>(</mo><msub><mi>L</mi><mi>d</mi></msub><mo>)</mo><mo>(</mo><msub><mi>e</mi><mn>1</mn></msub><mo>−</mo><msqrt><mrow><msubsup><mi>e</mi><mn>1</mn><mn>2</mn></msubsup><mo>−</mo><mn>2</mn><mi>k</mi><mi mathvariant="normal">∣</mi><msub><mi>L</mi><mi>d</mi></msub><mi mathvariant="normal">∣</mi></mrow></msqrt><mo>)</mo></mrow><mn>2</mn></mfrac><mo separator="true">,</mo><mspace width="2em"></mspace><msub><mi>C</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_0 = L_{cusp} + \frac {sgn(L_d)(e_1 - \sqrt{e_1^2 - 2 k |L_d|})} 2 ,\qquad C_0 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.63001em;"></span><span class="strut bottom" style="height:2.31601em;vertical-align:-0.686em;"></span><span class="uncramped textstyle base displaystyle"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord uncramped textstyle displaystyle reset-textstyle"><span class="size5 reset-size5 nulldelimiter reset-textstyle sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord mathrm">2</span></span></span><span style="top:-0.22999999999999998em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:1em;">​</span></span><span class="uncramped textstyle reset-textstyle frac-line"></span></span><span style="top:-0.680205em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:1em;">​</span></span><span class="uncramped textstyle reset-textstyle"><span class="mord uncramped textstyle"><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord sqrt"><span class="sqrt-sign" style="top:-0.05980500000000011em;"><span class="uncramped textstyle reset-textstyle style-wrap"><span class="delimsizing size1">√</span></span></span><span class="vlist"><span style="top:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.26630799999999993em;margin-left:0em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">1</span></span></span><span style="top:-0.34480000000000005em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">∣</span></span></span><span style="top:-0.869805em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:1em;">​</span></span><span class="uncramped textstyle reset-textstyle sqrt-line"></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="size5 reset-size5 nulldelimiter reset-textstyle sizing textstyle uncramped"></span></span><span class="mpunct">,</span><span class="mord mspace qquad"></span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span></span></p><p>Here are some results with different values for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span>:</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\large \alpha = 0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.773328em;"></span><span class="strut bottom" style="height:0.773328em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size6"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">5</span></span></span></span></span></span></p><div class="columns has-background-grey-lighter"><div class="column"><p><img alt="30" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/redslices/adaptive_L_cusp_0_05.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>3</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=30^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">3</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column"><p><img alt="120" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/yellowgreenslices/adaptive_L_cusp_0_05.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>1</mn><mn>2</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=120^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">2</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column is-half"><p><a href="/img/gamutclipping/flowers/adaptive_L_cusp_0_05.jpg"><img alt="flowers" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/adaptive_L_cusp_0_05.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Gamut clipping test</em></p></div></div><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\large \alpha = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.773328em;"></span><span class="strut bottom" style="height:0.773328em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size6"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span></p><div class="columns has-background-grey-lighter"><div class="column"><p><img alt="30" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/redslices/adaptive_L_cusp_0_50.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>3</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=30^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">3</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column"><p><img alt="120" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/yellowgreenslices/adaptive_L_cusp_0_50.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>1</mn><mn>2</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=120^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">2</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column is-half"><p><a href="/img/gamutclipping/flowers/adaptive_L_cusp_0_50.jpg"><img alt="flowers" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/adaptive_L_cusp_0_50.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Gamut clipping test</em></p></div></div><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\large \alpha = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.773328em;"></span><span class="strut bottom" style="height:0.773328em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size6"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span></p><div class="columns has-background-grey-lighter"><div class="column"><p><img alt="30" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/redslices/adaptive_L_cusp_5_00.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>3</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=30^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">3</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column"><p><img alt="120" decoding="async" height="561" loading="lazy" src="/img/gamutclipping/yellowgreenslices/adaptive_L_cusp_5_00.png" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 352px) min(calc(var(--main-width) * 1.59375), 561px);" width="352"> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>∘</mo></mrow></msup><mo>=</mo><mn>1</mn><mn>2</mn><msup><mn>0</mn><mrow><mo>∘</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{\circ}=120^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">2</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="uncramped scriptstyle reset-textstyle"><span class="mord uncramped scriptstyle"><span class="mord">∘</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p></div><div class="column is-half"><p><a href="/img/gamutclipping/flowers/adaptive_L_cusp_5_00.jpg"><img alt="flowers" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/adaptive_L_cusp_5_00.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Gamut clipping test</em></p></div></div><br><h2 id="results">Results <a href="#results" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h2><p>The following images compare RGB clipping with the five different gamut mapping methods above and a few choices of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span>, across different images. All images have had their colorfulness increased by scaling Oklab chroma and their exposure increased slightly.</p><p>The processing done here is for testing purposes only. I would not recommend doing image processing that creates this many invalid colors and solving it by gamut clipping. For example, in cases like this, some kind of gamut compressions would probably be a better choice.</p><p>All the original photos are by me and bot original images are results are licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a>.</p><h3 id="flowers">Flowers <a href="#flowers" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h3><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/flowers/original.jpg"><img alt="Original" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/original.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Unprocessed</em></p></div><div class="column"><p><a href="/img/gamutclipping/flowers/out_of_gamut.jpg"><img alt="Colors in gamut" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/out_of_gamut.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Colors in gamut</em></p></div><div class="column"><p><a href="/img/gamutclipping/flowers/clipped_rgb.jpg"><img alt="Clipped in RGB" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/clipped_rgb.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>RGB clipped</em></p></div></div><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/flowers/clipped_chroma.jpg"><img alt="Chroma clipped" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/clipped_chroma.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Chroma clipped</em></p></div><div class="column"><p><a href="/img/gamutclipping/flowers/sp_middle_grey.jpg"><img alt="Middle grey projection" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/sp_middle_grey.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span> projection</em></p></div><div class="column"><p><a href="/img/gamutclipping/flowers/sp_L_cusp.jpg"><img alt="L_cusp projection" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/sp_L_cusp.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span> projection</em></p></div></div><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/flowers/adaptive_middle_grey_0_05.jpg"><img alt="Adaptive 0.5 0.05" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/adaptive_middle_grey_0_05.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">5</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/flowers/adaptive_middle_grey_0_50.jpg"><img alt="Adaptive 0.5 0.50" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/adaptive_middle_grey_0_50.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/flowers/adaptive_middle_grey_5_00.jpg"><img alt="Adaptive 0.5 5.00" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/adaptive_middle_grey_5_00.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=5.00</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div></div><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/flowers/adaptive_L_cusp_0_05.jpg"><img alt="Adaptive L_cusp 0.05" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/adaptive_L_cusp_0_05.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">5</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/flowers/adaptive_L_cusp_0_50.jpg"><img alt="Adaptive L_cusp 0.50" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/adaptive_L_cusp_0_50.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/flowers/adaptive_L_cusp_5_00.jpg"><img alt="Adaptive L_cusp 5.00" decoding="async" height="378" loading="lazy" src="/img/gamutclipping/flowers/adaptive_L_cusp_5_00.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 504px) min(calc(var(--main-width) * 0.75), 378px);" width="504"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=5.00</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div></div><h3 id="lamp">Lamp <a href="#lamp" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h3><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/lamp/original.jpg"><img alt="Original" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/lamp/original.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Unprocessed</em></p></div><div class="column"><p><a href="/img/gamutclipping/lamp/out_of_gamut.jpg"><img alt="Colors in gamut" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/lamp/out_of_gamut.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Colors in gamut</em></p></div><div class="column"><p><a href="/img/gamutclipping/lamp/clipped_rgb.jpg"><img alt="Clipped in RGB" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/lamp/clipped_rgb.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>RGB clipped</em></p></div></div><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/lamp/clipped_chroma.jpg"><img alt="Chroma clipped" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/lamp/clipped_chroma.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Chroma clipped</em></p></div><div class="column"><p><a href="/img/gamutclipping/lamp/sp_middle_grey.jpg"><img alt="Middle grey projection" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/lamp/sp_middle_grey.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span> projection</em></p></div><div class="column"><p><a href="/img/gamutclipping/lamp/sp_L_cusp.jpg"><img alt="L_cusp projection" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/lamp/sp_L_cusp.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span> projection</em></p></div></div><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/lamp/adaptive_middle_grey_0_05.jpg"><img alt="Adaptive 0.5 0.05" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/lamp/adaptive_middle_grey_0_05.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">5</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/lamp/adaptive_middle_grey_0_50.jpg"><img alt="Adaptive 0.5 0.50" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/lamp/adaptive_middle_grey_0_50.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/lamp/adaptive_middle_grey_5_00.jpg"><img alt="Adaptive 0.5 5.00" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/lamp/adaptive_middle_grey_5_00.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=5.00</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div></div><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/lamp/adaptive_L_cusp_0_05.jpg"><img alt="Adaptive L_cusp 0.05" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/lamp/adaptive_L_cusp_0_05.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">5</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/lamp/adaptive_L_cusp_0_50.jpg"><img alt="Adaptive L_cusp 0.50" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/lamp/adaptive_L_cusp_0_50.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/lamp/adaptive_L_cusp_5_00.jpg"><img alt="Adaptive L_cusp 5.00" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/lamp/adaptive_L_cusp_5_00.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=5.00</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div></div><h3 id="tulip">Tulip <a href="#tulip" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h3><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/tulip/original.jpg"><img alt="Original" decoding="async" height="504" loading="lazy" src="/img/gamutclipping/tulip/original.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 378px) min(calc(var(--main-width) * 1.3333333333333333), 504px);" width="378"></a><em>Unprocessed</em></p></div><div class="column"><p><a href="/img/gamutclipping/tulip/out_of_gamut.jpg"><img alt="Colors in gamut" decoding="async" height="504" loading="lazy" src="/img/gamutclipping/tulip/out_of_gamut.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 378px) min(calc(var(--main-width) * 1.3333333333333333), 504px);" width="378"></a><em>Colors in gamut</em></p></div><div class="column"><p><a href="/img/gamutclipping/tulip/clipped_rgb.jpg"><img alt="Clipped in RGB" decoding="async" height="504" loading="lazy" src="/img/gamutclipping/tulip/clipped_rgb.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 378px) min(calc(var(--main-width) * 1.3333333333333333), 504px);" width="378"></a><em>RGB clipped</em></p></div></div><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/tulip/clipped_chroma.jpg"><img alt="Chroma clipped" decoding="async" height="504" loading="lazy" src="/img/gamutclipping/tulip/clipped_chroma.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 378px) min(calc(var(--main-width) * 1.3333333333333333), 504px);" width="378"></a><em>Chroma clipped</em></p></div><div class="column"><p><a href="/img/gamutclipping/tulip/sp_middle_grey.jpg"><img alt="Middle grey projection" decoding="async" height="504" loading="lazy" src="/img/gamutclipping/tulip/sp_middle_grey.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 378px) min(calc(var(--main-width) * 1.3333333333333333), 504px);" width="378"></a><em><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span> projection</em></p></div><div class="column"><p><a href="/img/gamutclipping/tulip/sp_L_cusp.jpg"><img alt="L_cusp projection" decoding="async" height="504" loading="lazy" src="/img/gamutclipping/tulip/sp_L_cusp.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 378px) min(calc(var(--main-width) * 1.3333333333333333), 504px);" width="378"></a><em><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span> projection</em></p></div></div><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/tulip/adaptive_middle_grey_0_05.jpg"><img alt="Adaptive 0.5 0.05" decoding="async" height="504" loading="lazy" src="/img/gamutclipping/tulip/adaptive_middle_grey_0_05.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 378px) min(calc(var(--main-width) * 1.3333333333333333), 504px);" width="378"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">5</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/tulip/adaptive_middle_grey_0_50.jpg"><img alt="Adaptive 0.5 0.50" decoding="async" height="504" loading="lazy" src="/img/gamutclipping/tulip/adaptive_middle_grey_0_50.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 378px) min(calc(var(--main-width) * 1.3333333333333333), 504px);" width="378"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/tulip/adaptive_middle_grey_5_00.jpg"><img alt="Adaptive 0.5 5.00" decoding="async" height="504" loading="lazy" src="/img/gamutclipping/tulip/adaptive_middle_grey_5_00.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 378px) min(calc(var(--main-width) * 1.3333333333333333), 504px);" width="378"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=5.00</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div></div><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/tulip/adaptive_L_cusp_0_05.jpg"><img alt="Adaptive L_cusp 0.05" decoding="async" height="504" loading="lazy" src="/img/gamutclipping/tulip/adaptive_L_cusp_0_05.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 378px) min(calc(var(--main-width) * 1.3333333333333333), 504px);" width="378"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">5</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/tulip/adaptive_L_cusp_0_50.jpg"><img alt="Adaptive L_cusp 0.50" decoding="async" height="504" loading="lazy" src="/img/gamutclipping/tulip/adaptive_L_cusp_0_50.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 378px) min(calc(var(--main-width) * 1.3333333333333333), 504px);" width="378"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/tulip/adaptive_L_cusp_5_00.jpg"><img alt="Adaptive L_cusp 5.00" decoding="async" height="504" loading="lazy" src="/img/gamutclipping/tulip/adaptive_L_cusp_5_00.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 378px) min(calc(var(--main-width) * 1.3333333333333333), 504px);" width="378"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=5.00</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div></div><h3 id="boat">Boat <a href="#boat" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h3><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/boat/original.jpg"><img alt="Original" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/boat/original.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Unprocessed</em></p></div><div class="column"><p><a href="/img/gamutclipping/boat/out_of_gamut.jpg"><img alt="Colors in gamut" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/boat/out_of_gamut.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Colors in gamut</em></p></div><div class="column"><p><a href="/img/gamutclipping/boat/clipped_rgb.jpg"><img alt="Clipped in RGB" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/boat/clipped_rgb.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>RGB clipped</em></p></div></div><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/boat/clipped_chroma.jpg"><img alt="Chroma clipped" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/boat/clipped_chroma.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Chroma clipped</em></p></div><div class="column"><p><a href="/img/gamutclipping/boat/sp_middle_grey.jpg"><img alt="Middle grey projection" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/boat/sp_middle_grey.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span> projection</em></p></div><div class="column"><p><a href="/img/gamutclipping/boat/sp_L_cusp.jpg"><img alt="L_cusp projection" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/boat/sp_L_cusp.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span> projection</em></p></div></div><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/boat/adaptive_middle_grey_0_05.jpg"><img alt="Adaptive 0.5 0.05" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/boat/adaptive_middle_grey_0_05.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">5</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/boat/adaptive_middle_grey_0_50.jpg"><img alt="Adaptive 0.5 0.50" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/boat/adaptive_middle_grey_0_50.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/boat/adaptive_middle_grey_5_00.jpg"><img alt="Adaptive 0.5 5.00" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/boat/adaptive_middle_grey_5_00.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.749997em;vertical-align:-0.135em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=5.00</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div></div><div class="columns has-background-grey-lighter"><div class="column"><p><a href="/img/gamutclipping/boat/adaptive_L_cusp_0_05.jpg"><img alt="Adaptive L_cusp 0.05" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/boat/adaptive_L_cusp_0_05.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">5</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/boat/adaptive_L_cusp_0_50.jpg"><img alt="Adaptive L_cusp 0.50" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/boat/adaptive_L_cusp_0_50.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=0.50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div><div class="column"><p><a href="/img/gamutclipping/boat/adaptive_L_cusp_5_00.jpg"><img alt="Adaptive L_cusp 5.00" decoding="async" height="750" loading="lazy" src="/img/gamutclipping/boat/adaptive_L_cusp_5_00.jpg" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 500px) min(calc(var(--main-width) * 1.5), 750px);" width="500"></a><em>Adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.614997em;"></span><span class="strut bottom" style="height:0.8724942em;vertical-align:-0.2574972em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size4"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="0.9em"><mi>α</mi><mo>=</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small \alpha=5.00</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5799960000000001em;"></span><span class="strut bottom" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="reset-size5 sizing textstyle uncramped size4"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span></span></span></em></p></div></div><h2 id="conclusions-and-future-work">Conclusions and future work <a href="#conclusions-and-future-work" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h2><p>Overall, doing gamut clipping using Oklab seems like a useful tool, and is fairly easy to implement. The results here though are not enough to determine how it compares with other algorithm or how results are perceived if comparing wide gamut images with clipped versions. Doing more studies and comparisons would be interesting.</p><p>Personally, of the methods evaluated here I think a good default choice would be adaptive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">L_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">5</span></span></span></span>, but in specific cases other methods and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span> values can definitely perform better. At <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">5</span></span></span></span> the choice between <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mrow><annotation encoding="application/x-tex">L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>s</mi><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_0 = L_{cusp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">s</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> seems to matter very little visually. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mrow><annotation encoding="application/x-tex">L_0 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span> is then preferable, since it is cheaper to compute, and can be implemented with a single 2D lookup table if desired (From hue and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">L_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="uncramped textstyle base"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span><span class="scriptstyle reset-textstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="size5 fontsize-ensurer reset-size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit">L</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="uncramped textstyle base"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span>).</p><p>There is also a lot of potential future work:</p><ul><li>Would be nice with a solution that could work directly with RGB matrices, instead of optimizing some constants separately. This way a solutions could be created quickly for any RGB color space.</li><li>One issue, that is related to the sRGB gamut rather than the clipping algorithm, is the sharp ridges of high chroma that sometimes get created. A smoothed version of the sRGB gamut could be interesting to clip to instead, producing a more even blend at the expense of some of the highly saturated colors.</li><li>There are also a lot of other applications for intersecting lines with the gamut to explore.</li></ul><p>My next post will be about creating HSV and HSL like color pickers with improved uniformity, utilizing the gamut intersection algorithm described here.</p><h2 id="source-code">Source code <a href="#source-code" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h2><p>All the source code on this page is provided under the MIT license:</p><pre><code>Copyright (c) 2021 Björn Ottosson

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
of the Software, and to permit persons to whom the Software is furnished to do
so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
</code></pre><h4 id="oklab-to-linear-srgb-conversion">Oklab to linear sRGB conversion <a href="#oklab-to-linear-srgb-conversion" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h4><p>Linear sRGB to Oklab conversion, identical to the <a href="https://bottosson.github.io/posts/oklab/">the Oklab blog post</a>.</p><p>This is using linear sRGB values in the range 0.0 to 1.0. To compute linear sRGB values, see <a href="https://bottosson.github.io/posts/colorwrong/#what-can-we-do%3F">my previous post</a>.</p><pre class="language-cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">Lab</span> <span class="token punctuation">{</span><span class="token keyword">float</span> L<span class="token punctuation">;</span> <span class="token keyword">float</span> a<span class="token punctuation">;</span> <span class="token keyword">float</span> b<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token keyword">struct</span> <span class="token class-name">RGB</span> <span class="token punctuation">{</span><span class="token keyword">float</span> r<span class="token punctuation">;</span> <span class="token keyword">float</span> g<span class="token punctuation">;</span> <span class="token keyword">float</span> b<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>Lab <span class="token function">linear_srgb_to_oklab</span><span class="token punctuation">(</span>RGB c<span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>	<span class="token keyword">float</span> l <span class="token operator">=</span> <span class="token number">0.4122214708f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>r <span class="token operator">+</span> <span class="token number">0.5363325363f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>g <span class="token operator">+</span> <span class="token number">0.0514459929f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>b<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> m <span class="token operator">=</span> <span class="token number">0.2119034982f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>r <span class="token operator">+</span> <span class="token number">0.6806995451f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>g <span class="token operator">+</span> <span class="token number">0.1073969566f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>b<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> s <span class="token operator">=</span> <span class="token number">0.0883024619f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>r <span class="token operator">+</span> <span class="token number">0.2817188376f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>g <span class="token operator">+</span> <span class="token number">0.6299787005f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>b<span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> l_ <span class="token operator">=</span> <span class="token function">cbrtf</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> m_ <span class="token operator">=</span> <span class="token function">cbrtf</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> s_ <span class="token operator">=</span> <span class="token function">cbrtf</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">return</span> <span class="token punctuation">{</span><br>		<span class="token number">0.2104542553f</span> <span class="token operator">*</span> l_ <span class="token operator">+</span> <span class="token number">0.7936177850f</span> <span class="token operator">*</span> m_ <span class="token operator">-</span> <span class="token number">0.0040720468f</span> <span class="token operator">*</span> s_<span class="token punctuation">,</span><br>		<span class="token number">1.9779984951f</span> <span class="token operator">*</span> l_ <span class="token operator">-</span> <span class="token number">2.4285922050f</span> <span class="token operator">*</span> m_ <span class="token operator">+</span> <span class="token number">0.4505937099f</span> <span class="token operator">*</span> s_<span class="token punctuation">,</span><br>		<span class="token number">0.0259040371f</span> <span class="token operator">*</span> l_ <span class="token operator">+</span> <span class="token number">0.7827717662f</span> <span class="token operator">*</span> m_ <span class="token operator">-</span> <span class="token number">0.8086757660f</span> <span class="token operator">*</span> s_<span class="token punctuation">,</span><br>	<span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>RGB <span class="token function">oklab_to_linear_srgb</span><span class="token punctuation">(</span>Lab c<span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>    <span class="token keyword">float</span> l_ <span class="token operator">=</span> c<span class="token punctuation">.</span>L <span class="token operator">+</span> <span class="token number">0.3963377774f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>a <span class="token operator">+</span> <span class="token number">0.2158037573f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>b<span class="token punctuation">;</span><br>    <span class="token keyword">float</span> m_ <span class="token operator">=</span> c<span class="token punctuation">.</span>L <span class="token operator">-</span> <span class="token number">0.1055613458f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>a <span class="token operator">-</span> <span class="token number">0.0638541728f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>b<span class="token punctuation">;</span><br>    <span class="token keyword">float</span> s_ <span class="token operator">=</span> c<span class="token punctuation">.</span>L <span class="token operator">-</span> <span class="token number">0.0894841775f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>a <span class="token operator">-</span> <span class="token number">1.2914855480f</span> <span class="token operator">*</span> c<span class="token punctuation">.</span>b<span class="token punctuation">;</span><br><br>    <span class="token keyword">float</span> l <span class="token operator">=</span> l_ <span class="token operator">*</span> l_ <span class="token operator">*</span> l_<span class="token punctuation">;</span><br>    <span class="token keyword">float</span> m <span class="token operator">=</span> m_ <span class="token operator">*</span> m_ <span class="token operator">*</span> m_<span class="token punctuation">;</span><br>    <span class="token keyword">float</span> s <span class="token operator">=</span> s_ <span class="token operator">*</span> s_ <span class="token operator">*</span> s_<span class="token punctuation">;</span><br><br>    <span class="token keyword">return</span> <span class="token punctuation">{</span><br>        <span class="token operator">+</span><span class="token number">4.0767416621f</span> <span class="token operator">*</span> l <span class="token operator">-</span> <span class="token number">3.3077115913f</span> <span class="token operator">*</span> m <span class="token operator">+</span> <span class="token number">0.2309699292f</span> <span class="token operator">*</span> s<span class="token punctuation">,</span><br>        <span class="token operator">-</span><span class="token number">1.2684380046f</span> <span class="token operator">*</span> l <span class="token operator">+</span> <span class="token number">2.6097574011f</span> <span class="token operator">*</span> m <span class="token operator">-</span> <span class="token number">0.3413193965f</span> <span class="token operator">*</span> s<span class="token punctuation">,</span><br>        <span class="token operator">-</span><span class="token number">0.0041960863f</span> <span class="token operator">*</span> l <span class="token operator">-</span> <span class="token number">0.7034186147f</span> <span class="token operator">*</span> m <span class="token operator">+</span> <span class="token number">1.7076147010f</span> <span class="token operator">*</span> s<span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h4 id="intersection-with-srgb-gamut">Intersection with sRGB gamut <a href="#intersection-with-srgb-gamut" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h4><p>Implementations of the sRGB gamut intersection algorithm. The code has been written to be easy to follow. Consider optimizing for your use case.</p><pre class="language-cpp"><code class="language-cpp"><span class="token comment">// Finds the maximum saturation possible for a given hue that fits in sRGB</span><br><span class="token comment">// Saturation here is defined as S = C/L</span><br><span class="token comment">// a and b must be normalized so a^2 + b^2 == 1</span><br><span class="token keyword">float</span> <span class="token function">compute_max_saturation</span><span class="token punctuation">(</span><span class="token keyword">float</span> a<span class="token punctuation">,</span> <span class="token keyword">float</span> b<span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>    <span class="token comment">// Max saturation will be when one of r, g or b goes below zero.</span><br><br>    <span class="token comment">// Select different coefficients depending on which component goes below zero first</span><br>    <span class="token keyword">float</span> k0<span class="token punctuation">,</span> k1<span class="token punctuation">,</span> k2<span class="token punctuation">,</span> k3<span class="token punctuation">,</span> k4<span class="token punctuation">,</span> wl<span class="token punctuation">,</span> wm<span class="token punctuation">,</span> ws<span class="token punctuation">;</span><br><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.88170328f</span> <span class="token operator">*</span> a <span class="token operator">-</span> <span class="token number">0.80936493f</span> <span class="token operator">*</span> b <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><br>    <span class="token punctuation">{</span><br>        <span class="token comment">// Red component</span><br>        k0 <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">1.19086277f</span><span class="token punctuation">;</span> k1 <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">1.76576728f</span><span class="token punctuation">;</span> k2 <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">0.59662641f</span><span class="token punctuation">;</span> k3 <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">0.75515197f</span><span class="token punctuation">;</span> k4 <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">0.56771245f</span><span class="token punctuation">;</span><br>        wl <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">4.0767416621f</span><span class="token punctuation">;</span> wm <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3.3077115913f</span><span class="token punctuation">;</span> ws <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">0.2309699292f</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1.81444104f</span> <span class="token operator">*</span> a <span class="token operator">-</span> <span class="token number">1.19445276f</span> <span class="token operator">*</span> b <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><br>    <span class="token punctuation">{</span><br>        <span class="token comment">// Green component</span><br>        k0 <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">0.73956515f</span><span class="token punctuation">;</span> k1 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.45954404f</span><span class="token punctuation">;</span> k2 <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">0.08285427f</span><span class="token punctuation">;</span> k3 <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">0.12541070f</span><span class="token punctuation">;</span> k4 <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">0.14503204f</span><span class="token punctuation">;</span><br>        wl <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1.2681437731f</span><span class="token punctuation">;</span> wm <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">2.6097574011f</span><span class="token punctuation">;</span> ws <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.3413193965f</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">else</span><br>    <span class="token punctuation">{</span><br>        <span class="token comment">// Blue component</span><br>        k0 <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">1.35733652f</span><span class="token punctuation">;</span> k1 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.00915799f</span><span class="token punctuation">;</span> k2 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1.15130210f</span><span class="token punctuation">;</span> k3 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.50559606f</span><span class="token punctuation">;</span> k4 <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">0.00692167f</span><span class="token punctuation">;</span><br>        wl <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.0041960863f</span><span class="token punctuation">;</span> wm <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.7034186147f</span><span class="token punctuation">;</span> ws <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">1.7076147010f</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Approximate max saturation using a polynomial:</span><br>    <span class="token keyword">float</span> S <span class="token operator">=</span> k0 <span class="token operator">+</span> k1 <span class="token operator">*</span> a <span class="token operator">+</span> k2 <span class="token operator">*</span> b <span class="token operator">+</span> k3 <span class="token operator">*</span> a <span class="token operator">*</span> a <span class="token operator">+</span> k4 <span class="token operator">*</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span><br><br>    <span class="token comment">// Do one step Halley's method to get closer</span><br>    <span class="token comment">// this gives an error less than 10e6, except for some blue hues where the dS/dh is close to infinite</span><br>    <span class="token comment">// this should be sufficient for most applications, otherwise do two/three steps </span><br><br>    <span class="token keyword">float</span> k_l <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">0.3963377774f</span> <span class="token operator">*</span> a <span class="token operator">+</span> <span class="token number">0.2158037573f</span> <span class="token operator">*</span> b<span class="token punctuation">;</span><br>    <span class="token keyword">float</span> k_m <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.1055613458f</span> <span class="token operator">*</span> a <span class="token operator">-</span> <span class="token number">0.0638541728f</span> <span class="token operator">*</span> b<span class="token punctuation">;</span><br>    <span class="token keyword">float</span> k_s <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.0894841775f</span> <span class="token operator">*</span> a <span class="token operator">-</span> <span class="token number">1.2914855480f</span> <span class="token operator">*</span> b<span class="token punctuation">;</span><br><br>    <span class="token punctuation">{</span><br>        <span class="token keyword">float</span> l_ <span class="token operator">=</span> <span class="token number">1.f</span> <span class="token operator">+</span> S <span class="token operator">*</span> k_l<span class="token punctuation">;</span><br>        <span class="token keyword">float</span> m_ <span class="token operator">=</span> <span class="token number">1.f</span> <span class="token operator">+</span> S <span class="token operator">*</span> k_m<span class="token punctuation">;</span><br>        <span class="token keyword">float</span> s_ <span class="token operator">=</span> <span class="token number">1.f</span> <span class="token operator">+</span> S <span class="token operator">*</span> k_s<span class="token punctuation">;</span><br><br>        <span class="token keyword">float</span> l <span class="token operator">=</span> l_ <span class="token operator">*</span> l_ <span class="token operator">*</span> l_<span class="token punctuation">;</span><br>        <span class="token keyword">float</span> m <span class="token operator">=</span> m_ <span class="token operator">*</span> m_ <span class="token operator">*</span> m_<span class="token punctuation">;</span><br>        <span class="token keyword">float</span> s <span class="token operator">=</span> s_ <span class="token operator">*</span> s_ <span class="token operator">*</span> s_<span class="token punctuation">;</span><br><br>        <span class="token keyword">float</span> l_dS <span class="token operator">=</span> <span class="token number">3.f</span> <span class="token operator">*</span> k_l <span class="token operator">*</span> l_ <span class="token operator">*</span> l_<span class="token punctuation">;</span><br>        <span class="token keyword">float</span> m_dS <span class="token operator">=</span> <span class="token number">3.f</span> <span class="token operator">*</span> k_m <span class="token operator">*</span> m_ <span class="token operator">*</span> m_<span class="token punctuation">;</span><br>        <span class="token keyword">float</span> s_dS <span class="token operator">=</span> <span class="token number">3.f</span> <span class="token operator">*</span> k_s <span class="token operator">*</span> s_ <span class="token operator">*</span> s_<span class="token punctuation">;</span><br><br>        <span class="token keyword">float</span> l_dS2 <span class="token operator">=</span> <span class="token number">6.f</span> <span class="token operator">*</span> k_l <span class="token operator">*</span> k_l <span class="token operator">*</span> l_<span class="token punctuation">;</span><br>        <span class="token keyword">float</span> m_dS2 <span class="token operator">=</span> <span class="token number">6.f</span> <span class="token operator">*</span> k_m <span class="token operator">*</span> k_m <span class="token operator">*</span> m_<span class="token punctuation">;</span><br>        <span class="token keyword">float</span> s_dS2 <span class="token operator">=</span> <span class="token number">6.f</span> <span class="token operator">*</span> k_s <span class="token operator">*</span> k_s <span class="token operator">*</span> s_<span class="token punctuation">;</span><br><br>        <span class="token keyword">float</span> f  <span class="token operator">=</span> wl <span class="token operator">*</span> l     <span class="token operator">+</span> wm <span class="token operator">*</span> m     <span class="token operator">+</span> ws <span class="token operator">*</span> s<span class="token punctuation">;</span><br>        <span class="token keyword">float</span> f1 <span class="token operator">=</span> wl <span class="token operator">*</span> l_dS  <span class="token operator">+</span> wm <span class="token operator">*</span> m_dS  <span class="token operator">+</span> ws <span class="token operator">*</span> s_dS<span class="token punctuation">;</span><br>        <span class="token keyword">float</span> f2 <span class="token operator">=</span> wl <span class="token operator">*</span> l_dS2 <span class="token operator">+</span> wm <span class="token operator">*</span> m_dS2 <span class="token operator">+</span> ws <span class="token operator">*</span> s_dS2<span class="token punctuation">;</span><br><br>        S <span class="token operator">=</span> S <span class="token operator">-</span> f <span class="token operator">*</span> f1 <span class="token operator">/</span> <span class="token punctuation">(</span>f1<span class="token operator">*</span>f1 <span class="token operator">-</span> <span class="token number">0.5f</span> <span class="token operator">*</span> f <span class="token operator">*</span> f2<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">return</span> S<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// finds L_cusp and C_cusp for a given hue</span><br><span class="token comment">// a and b must be normalized so a^2 + b^2 == 1</span><br><span class="token keyword">struct</span> <span class="token class-name">LC</span> <span class="token punctuation">{</span> <span class="token keyword">float</span> L<span class="token punctuation">;</span> <span class="token keyword">float</span> C<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>LC <span class="token function">find_cusp</span><span class="token punctuation">(</span><span class="token keyword">float</span> a<span class="token punctuation">,</span> <span class="token keyword">float</span> b<span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>	<span class="token comment">// First, find the maximum saturation (saturation S = C/L)</span><br>	<span class="token keyword">float</span> S_cusp <span class="token operator">=</span> <span class="token function">compute_max_saturation</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token comment">// Convert to linear sRGB to find the first point where at least one of r,g or b &gt;= 1:</span><br>	RGB rgb_at_max <span class="token operator">=</span> <span class="token function">oklab_to_linear_srgb</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> S_cusp <span class="token operator">*</span> a<span class="token punctuation">,</span> S_cusp <span class="token operator">*</span> b <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> L_cusp <span class="token operator">=</span> <span class="token function">cbrtf</span><span class="token punctuation">(</span><span class="token number">1.f</span> <span class="token operator">/</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>rgb_at_max<span class="token punctuation">.</span>r<span class="token punctuation">,</span> rgb_at_max<span class="token punctuation">.</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> rgb_at_max<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> C_cusp <span class="token operator">=</span> L_cusp <span class="token operator">*</span> S_cusp<span class="token punctuation">;</span><br><br>	<span class="token keyword">return</span> <span class="token punctuation">{</span> L_cusp <span class="token punctuation">,</span> C_cusp <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// Finds intersection of the line defined by </span><br><span class="token comment">// L = L0 * (1 - t) + t * L1;</span><br><span class="token comment">// C = t * C1;</span><br><span class="token comment">// a and b must be normalized so a^2 + b^2 == 1</span><br><span class="token keyword">float</span> <span class="token function">find_gamut_intersection</span><span class="token punctuation">(</span><span class="token keyword">float</span> a<span class="token punctuation">,</span> <span class="token keyword">float</span> b<span class="token punctuation">,</span> <span class="token keyword">float</span> L1<span class="token punctuation">,</span> <span class="token keyword">float</span> C1<span class="token punctuation">,</span> <span class="token keyword">float</span> L0<span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>	<span class="token comment">// Find the cusp of the gamut triangle</span><br>	LC cusp <span class="token operator">=</span> <span class="token function">find_cusp</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token comment">// Find the intersection for upper and lower half seprately</span><br>	<span class="token keyword">float</span> t<span class="token punctuation">;</span><br>	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>L1 <span class="token operator">-</span> L0<span class="token punctuation">)</span> <span class="token operator">*</span> cusp<span class="token punctuation">.</span>C <span class="token operator">-</span> <span class="token punctuation">(</span>cusp<span class="token punctuation">.</span>L <span class="token operator">-</span> L0<span class="token punctuation">)</span> <span class="token operator">*</span> C1<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0.f</span><span class="token punctuation">)</span><br>	<span class="token punctuation">{</span><br>		<span class="token comment">// Lower half</span><br><br>		t <span class="token operator">=</span> cusp<span class="token punctuation">.</span>C <span class="token operator">*</span> L0 <span class="token operator">/</span> <span class="token punctuation">(</span>C1 <span class="token operator">*</span> cusp<span class="token punctuation">.</span>L <span class="token operator">+</span> cusp<span class="token punctuation">.</span>C <span class="token operator">*</span> <span class="token punctuation">(</span>L0 <span class="token operator">-</span> L1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token punctuation">}</span><br>	<span class="token keyword">else</span><br>	<span class="token punctuation">{</span><br>		<span class="token comment">// Upper half</span><br><br>		<span class="token comment">// First intersect with triangle</span><br>		t <span class="token operator">=</span> cusp<span class="token punctuation">.</span>C <span class="token operator">*</span> <span class="token punctuation">(</span>L0 <span class="token operator">-</span> <span class="token number">1.f</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>C1 <span class="token operator">*</span> <span class="token punctuation">(</span>cusp<span class="token punctuation">.</span>L <span class="token operator">-</span> <span class="token number">1.f</span><span class="token punctuation">)</span> <span class="token operator">+</span> cusp<span class="token punctuation">.</span>C <span class="token operator">*</span> <span class="token punctuation">(</span>L0 <span class="token operator">-</span> L1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>		<span class="token comment">// Then one step Halley's method</span><br>		<span class="token punctuation">{</span><br>			<span class="token keyword">float</span> dL <span class="token operator">=</span> L1 <span class="token operator">-</span> L0<span class="token punctuation">;</span><br>			<span class="token keyword">float</span> dC <span class="token operator">=</span> C1<span class="token punctuation">;</span><br><br>			<span class="token keyword">float</span> k_l <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">0.3963377774f</span> <span class="token operator">*</span> a <span class="token operator">+</span> <span class="token number">0.2158037573f</span> <span class="token operator">*</span> b<span class="token punctuation">;</span><br>			<span class="token keyword">float</span> k_m <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.1055613458f</span> <span class="token operator">*</span> a <span class="token operator">-</span> <span class="token number">0.0638541728f</span> <span class="token operator">*</span> b<span class="token punctuation">;</span><br>			<span class="token keyword">float</span> k_s <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.0894841775f</span> <span class="token operator">*</span> a <span class="token operator">-</span> <span class="token number">1.2914855480f</span> <span class="token operator">*</span> b<span class="token punctuation">;</span><br><br>			<span class="token keyword">float</span> l_dt <span class="token operator">=</span> dL <span class="token operator">+</span> dC <span class="token operator">*</span> k_l<span class="token punctuation">;</span><br>			<span class="token keyword">float</span> m_dt <span class="token operator">=</span> dL <span class="token operator">+</span> dC <span class="token operator">*</span> k_m<span class="token punctuation">;</span><br>			<span class="token keyword">float</span> s_dt <span class="token operator">=</span> dL <span class="token operator">+</span> dC <span class="token operator">*</span> k_s<span class="token punctuation">;</span><br><br>			<br>			<span class="token comment">// If higher accuracy is required, 2 or 3 iterations of the following block can be used:</span><br>			<span class="token punctuation">{</span><br>				<span class="token keyword">float</span> L <span class="token operator">=</span> L0 <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.f</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">+</span> t <span class="token operator">*</span> L1<span class="token punctuation">;</span><br>				<span class="token keyword">float</span> C <span class="token operator">=</span> t <span class="token operator">*</span> C1<span class="token punctuation">;</span><br><br>				<span class="token keyword">float</span> l_ <span class="token operator">=</span> L <span class="token operator">+</span> C <span class="token operator">*</span> k_l<span class="token punctuation">;</span><br>				<span class="token keyword">float</span> m_ <span class="token operator">=</span> L <span class="token operator">+</span> C <span class="token operator">*</span> k_m<span class="token punctuation">;</span><br>				<span class="token keyword">float</span> s_ <span class="token operator">=</span> L <span class="token operator">+</span> C <span class="token operator">*</span> k_s<span class="token punctuation">;</span><br><br>				<span class="token keyword">float</span> l <span class="token operator">=</span> l_ <span class="token operator">*</span> l_ <span class="token operator">*</span> l_<span class="token punctuation">;</span><br>				<span class="token keyword">float</span> m <span class="token operator">=</span> m_ <span class="token operator">*</span> m_ <span class="token operator">*</span> m_<span class="token punctuation">;</span><br>				<span class="token keyword">float</span> s <span class="token operator">=</span> s_ <span class="token operator">*</span> s_ <span class="token operator">*</span> s_<span class="token punctuation">;</span><br><br>				<span class="token keyword">float</span> ldt <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">*</span> l_dt <span class="token operator">*</span> l_ <span class="token operator">*</span> l_<span class="token punctuation">;</span><br>				<span class="token keyword">float</span> mdt <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">*</span> m_dt <span class="token operator">*</span> m_ <span class="token operator">*</span> m_<span class="token punctuation">;</span><br>				<span class="token keyword">float</span> sdt <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">*</span> s_dt <span class="token operator">*</span> s_ <span class="token operator">*</span> s_<span class="token punctuation">;</span><br><br>				<span class="token keyword">float</span> ldt2 <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">*</span> l_dt <span class="token operator">*</span> l_dt <span class="token operator">*</span> l_<span class="token punctuation">;</span><br>				<span class="token keyword">float</span> mdt2 <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">*</span> m_dt <span class="token operator">*</span> m_dt <span class="token operator">*</span> m_<span class="token punctuation">;</span><br>				<span class="token keyword">float</span> sdt2 <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">*</span> s_dt <span class="token operator">*</span> s_dt <span class="token operator">*</span> s_<span class="token punctuation">;</span><br><br>				<span class="token keyword">float</span> r <span class="token operator">=</span> <span class="token number">4.0767416621f</span> <span class="token operator">*</span> l <span class="token operator">-</span> <span class="token number">3.3077115913f</span> <span class="token operator">*</span> m <span class="token operator">+</span> <span class="token number">0.2309699292f</span> <span class="token operator">*</span> s <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><br>				<span class="token keyword">float</span> r1 <span class="token operator">=</span> <span class="token number">4.0767416621f</span> <span class="token operator">*</span> ldt <span class="token operator">-</span> <span class="token number">3.3077115913f</span> <span class="token operator">*</span> mdt <span class="token operator">+</span> <span class="token number">0.2309699292f</span> <span class="token operator">*</span> sdt<span class="token punctuation">;</span><br>				<span class="token keyword">float</span> r2 <span class="token operator">=</span> <span class="token number">4.0767416621f</span> <span class="token operator">*</span> ldt2 <span class="token operator">-</span> <span class="token number">3.3077115913f</span> <span class="token operator">*</span> mdt2 <span class="token operator">+</span> <span class="token number">0.2309699292f</span> <span class="token operator">*</span> sdt2<span class="token punctuation">;</span><br><br>				<span class="token keyword">float</span> u_r <span class="token operator">=</span> r1 <span class="token operator">/</span> <span class="token punctuation">(</span>r1 <span class="token operator">*</span> r1 <span class="token operator">-</span> <span class="token number">0.5f</span> <span class="token operator">*</span> r <span class="token operator">*</span> r2<span class="token punctuation">)</span><span class="token punctuation">;</span><br>				<span class="token keyword">float</span> t_r <span class="token operator">=</span> <span class="token operator">-</span>r <span class="token operator">*</span> u_r<span class="token punctuation">;</span><br><br>				<span class="token keyword">float</span> g <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1.2681437731f</span> <span class="token operator">*</span> l <span class="token operator">+</span> <span class="token number">2.6097574011f</span> <span class="token operator">*</span> m <span class="token operator">-</span> <span class="token number">0.3413193965f</span> <span class="token operator">*</span> s <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><br>				<span class="token keyword">float</span> g1 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1.2681437731f</span> <span class="token operator">*</span> ldt <span class="token operator">+</span> <span class="token number">2.6097574011f</span> <span class="token operator">*</span> mdt <span class="token operator">-</span> <span class="token number">0.3413193965f</span> <span class="token operator">*</span> sdt<span class="token punctuation">;</span><br>				<span class="token keyword">float</span> g2 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1.2681437731f</span> <span class="token operator">*</span> ldt2 <span class="token operator">+</span> <span class="token number">2.6097574011f</span> <span class="token operator">*</span> mdt2 <span class="token operator">-</span> <span class="token number">0.3413193965f</span> <span class="token operator">*</span> sdt2<span class="token punctuation">;</span><br><br>				<span class="token keyword">float</span> u_g <span class="token operator">=</span> g1 <span class="token operator">/</span> <span class="token punctuation">(</span>g1 <span class="token operator">*</span> g1 <span class="token operator">-</span> <span class="token number">0.5f</span> <span class="token operator">*</span> g <span class="token operator">*</span> g2<span class="token punctuation">)</span><span class="token punctuation">;</span><br>				<span class="token keyword">float</span> t_g <span class="token operator">=</span> <span class="token operator">-</span>g <span class="token operator">*</span> u_g<span class="token punctuation">;</span><br><br>				<span class="token keyword">float</span> b <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.0041960863f</span> <span class="token operator">*</span> l <span class="token operator">-</span> <span class="token number">0.7034186147f</span> <span class="token operator">*</span> m <span class="token operator">+</span> <span class="token number">1.7076147010f</span> <span class="token operator">*</span> s <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><br>				<span class="token keyword">float</span> b1 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.0041960863f</span> <span class="token operator">*</span> ldt <span class="token operator">-</span> <span class="token number">0.7034186147f</span> <span class="token operator">*</span> mdt <span class="token operator">+</span> <span class="token number">1.7076147010f</span> <span class="token operator">*</span> sdt<span class="token punctuation">;</span><br>				<span class="token keyword">float</span> b2 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.0041960863f</span> <span class="token operator">*</span> ldt2 <span class="token operator">-</span> <span class="token number">0.7034186147f</span> <span class="token operator">*</span> mdt2 <span class="token operator">+</span> <span class="token number">1.7076147010f</span> <span class="token operator">*</span> sdt2<span class="token punctuation">;</span><br><br>				<span class="token keyword">float</span> u_b <span class="token operator">=</span> b1 <span class="token operator">/</span> <span class="token punctuation">(</span>b1 <span class="token operator">*</span> b1 <span class="token operator">-</span> <span class="token number">0.5f</span> <span class="token operator">*</span> b <span class="token operator">*</span> b2<span class="token punctuation">)</span><span class="token punctuation">;</span><br>				<span class="token keyword">float</span> t_b <span class="token operator">=</span> <span class="token operator">-</span>b <span class="token operator">*</span> u_b<span class="token punctuation">;</span><br><br>				t_r <span class="token operator">=</span> u_r <span class="token operator">&gt;=</span> <span class="token number">0.f</span> <span class="token operator">?</span> t_r <span class="token operator">:</span> FLT_MAX<span class="token punctuation">;</span><br>				t_g <span class="token operator">=</span> u_g <span class="token operator">&gt;=</span> <span class="token number">0.f</span> <span class="token operator">?</span> t_g <span class="token operator">:</span> FLT_MAX<span class="token punctuation">;</span><br>				t_b <span class="token operator">=</span> u_b <span class="token operator">&gt;=</span> <span class="token number">0.f</span> <span class="token operator">?</span> t_b <span class="token operator">:</span> FLT_MAX<span class="token punctuation">;</span><br><br>				t <span class="token operator">+=</span> <span class="token function">min</span><span class="token punctuation">(</span>t_r<span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>t_g<span class="token punctuation">,</span> t_b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>			<span class="token punctuation">}</span><br>		<span class="token punctuation">}</span><br>	<span class="token punctuation">}</span><br><br>	<span class="token keyword">return</span> t<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br></code></pre><h4 id="gamut-clipping-2">Gamut clipping <a href="#gamut-clipping-2" class="anchor-link"><span class="icon is-small"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 512 512" version="1.1" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M459.654,233.373l-90.531,90.5c-49.969,50-131.031,50-181,0c-7.875-7.844-14.031-16.688-19.438-25.813  l42.063-42.063c2-2.016,4.469-3.172,6.828-4.531c2.906,9.938,7.984,19.344,15.797,27.156c24.953,24.969,65.563,24.938,90.5,0  l90.5-90.5c24.969-24.969,24.969-65.563,0-90.516c-24.938-24.953-65.531-24.953-90.5,0l-32.188,32.219  c-26.109-10.172-54.25-12.906-81.641-8.891l68.578-68.578c50-49.984,131.031-49.984,181.031,0  C509.623,102.342,509.623,183.389,459.654,233.373z M220.326,382.186l-32.203,32.219c-24.953,24.938-65.563,24.938-90.516,0  c-24.953-24.969-24.953-65.563,0-90.531l90.516-90.5c24.969-24.969,65.547-24.969,90.5,0c7.797,7.797,12.875,17.203,15.813,27.125  c2.375-1.375,4.813-2.5,6.813-4.5l42.063-42.047c-5.375-9.156-11.563-17.969-19.438-25.828c-49.969-49.984-131.031-49.984-181.016,0  l-90.5,90.5c-49.984,50-49.984,131.031,0,181.031c49.984,49.969,131.031,49.969,181.016,0l68.594-68.594  C274.561,395.092,246.42,392.342,220.326,382.186z"></path></svg><span></span></span></a></h4><p>Implementations of the gamut clipping methods in this article. The code has been written to be easy to follow. Consider optimizing for your use case.</p><pre class="language-cpp"><code class="language-cpp"><br><span class="token keyword">float</span> <span class="token function">clamp</span><span class="token punctuation">(</span><span class="token keyword">float</span> x<span class="token punctuation">,</span> <span class="token keyword">float</span> min<span class="token punctuation">,</span> <span class="token keyword">float</span> max<span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>	<span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> min<span class="token punctuation">)</span><br>		<span class="token keyword">return</span> min<span class="token punctuation">;</span><br>	<span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> max<span class="token punctuation">)</span><br>		<span class="token keyword">return</span> max<span class="token punctuation">;</span><br><br>	<span class="token keyword">return</span> x<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">float</span> <span class="token function">sgn</span><span class="token punctuation">(</span><span class="token keyword">float</span> x<span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0.f</span> <span class="token operator">&lt;</span> x<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">0.f</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>RGB <span class="token function">gamut_clip_preserve_chroma</span><span class="token punctuation">(</span>RGB rgb<span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>	<span class="token keyword">if</span> <span class="token punctuation">(</span>rgb<span class="token punctuation">.</span>r <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>g <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>b <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>r <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>g <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>b <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><br>		<span class="token keyword">return</span> rgb<span class="token punctuation">;</span><br><br>	Lab lab <span class="token operator">=</span> <span class="token function">linear_srgb_to_oklab</span><span class="token punctuation">(</span>rgb<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> L <span class="token operator">=</span> lab<span class="token punctuation">.</span>L<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> eps <span class="token operator">=</span> <span class="token number">0.00001f</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> C <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>eps<span class="token punctuation">,</span> <span class="token function">sqrtf</span><span class="token punctuation">(</span>lab<span class="token punctuation">.</span>a <span class="token operator">*</span> lab<span class="token punctuation">.</span>a <span class="token operator">+</span> lab<span class="token punctuation">.</span>b <span class="token operator">*</span> lab<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> a_ <span class="token operator">=</span> lab<span class="token punctuation">.</span>a <span class="token operator">/</span> C<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> b_ <span class="token operator">=</span> lab<span class="token punctuation">.</span>b <span class="token operator">/</span> C<span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> L0 <span class="token operator">=</span> <span class="token function">clamp</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> t <span class="token operator">=</span> <span class="token function">find_gamut_intersection</span><span class="token punctuation">(</span>a_<span class="token punctuation">,</span> b_<span class="token punctuation">,</span> L<span class="token punctuation">,</span> C<span class="token punctuation">,</span> L0<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> L_clipped <span class="token operator">=</span> L0 <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">+</span> t <span class="token operator">*</span> L<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> C_clipped <span class="token operator">=</span> t <span class="token operator">*</span> C<span class="token punctuation">;</span><br><br>	<span class="token keyword">return</span> <span class="token function">oklab_to_linear_srgb</span><span class="token punctuation">(</span><span class="token punctuation">{</span> L_clipped<span class="token punctuation">,</span> C_clipped <span class="token operator">*</span> a_<span class="token punctuation">,</span> C_clipped <span class="token operator">*</span> b_ <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>RGB <span class="token function">gamut_clip_project_to_0_5</span><span class="token punctuation">(</span>RGB rgb<span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>	<span class="token keyword">if</span> <span class="token punctuation">(</span>rgb<span class="token punctuation">.</span>r <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>g <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>b <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>r <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>g <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>b <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><br>		<span class="token keyword">return</span> rgb<span class="token punctuation">;</span><br><br>	Lab lab <span class="token operator">=</span> <span class="token function">linear_srgb_to_oklab</span><span class="token punctuation">(</span>rgb<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> L <span class="token operator">=</span> lab<span class="token punctuation">.</span>L<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> eps <span class="token operator">=</span> <span class="token number">0.00001f</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> C <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>eps<span class="token punctuation">,</span> <span class="token function">sqrtf</span><span class="token punctuation">(</span>lab<span class="token punctuation">.</span>a <span class="token operator">*</span> lab<span class="token punctuation">.</span>a <span class="token operator">+</span> lab<span class="token punctuation">.</span>b <span class="token operator">*</span> lab<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> a_ <span class="token operator">=</span> lab<span class="token punctuation">.</span>a <span class="token operator">/</span> C<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> b_ <span class="token operator">=</span> lab<span class="token punctuation">.</span>b <span class="token operator">/</span> C<span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> L0 <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> t <span class="token operator">=</span> <span class="token function">find_gamut_intersection</span><span class="token punctuation">(</span>a_<span class="token punctuation">,</span> b_<span class="token punctuation">,</span> L<span class="token punctuation">,</span> C<span class="token punctuation">,</span> L0<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> L_clipped <span class="token operator">=</span> L0 <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">+</span> t <span class="token operator">*</span> L<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> C_clipped <span class="token operator">=</span> t <span class="token operator">*</span> C<span class="token punctuation">;</span><br><br>	<span class="token keyword">return</span> <span class="token function">oklab_to_linear_srgb</span><span class="token punctuation">(</span><span class="token punctuation">{</span> L_clipped<span class="token punctuation">,</span> C_clipped <span class="token operator">*</span> a_<span class="token punctuation">,</span> C_clipped <span class="token operator">*</span> b_ <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>RGB <span class="token function">gamut_clip_project_to_L_cusp</span><span class="token punctuation">(</span>RGB rgb<span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>	<span class="token keyword">if</span> <span class="token punctuation">(</span>rgb<span class="token punctuation">.</span>r <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>g <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>b <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>r <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>g <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>b <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><br>		<span class="token keyword">return</span> rgb<span class="token punctuation">;</span><br><br>	Lab lab <span class="token operator">=</span> <span class="token function">linear_srgb_to_oklab</span><span class="token punctuation">(</span>rgb<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> L <span class="token operator">=</span> lab<span class="token punctuation">.</span>L<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> eps <span class="token operator">=</span> <span class="token number">0.00001f</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> C <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>eps<span class="token punctuation">,</span> <span class="token function">sqrtf</span><span class="token punctuation">(</span>lab<span class="token punctuation">.</span>a <span class="token operator">*</span> lab<span class="token punctuation">.</span>a <span class="token operator">+</span> lab<span class="token punctuation">.</span>b <span class="token operator">*</span> lab<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> a_ <span class="token operator">=</span> lab<span class="token punctuation">.</span>a <span class="token operator">/</span> C<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> b_ <span class="token operator">=</span> lab<span class="token punctuation">.</span>b <span class="token operator">/</span> C<span class="token punctuation">;</span><br><br>	<span class="token comment">// The cusp is computed here and in find_gamut_intersection, an optimized solution would only compute it once.</span><br>	LC cusp <span class="token operator">=</span> <span class="token function">find_cusp</span><span class="token punctuation">(</span>a_<span class="token punctuation">,</span> b_<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> L0 <span class="token operator">=</span> cusp<span class="token punctuation">.</span>L<span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> t <span class="token operator">=</span> <span class="token function">find_gamut_intersection</span><span class="token punctuation">(</span>a_<span class="token punctuation">,</span> b_<span class="token punctuation">,</span> L<span class="token punctuation">,</span> C<span class="token punctuation">,</span> L0<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> L_clipped <span class="token operator">=</span> L0 <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">+</span> t <span class="token operator">*</span> L<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> C_clipped <span class="token operator">=</span> t <span class="token operator">*</span> C<span class="token punctuation">;</span><br><br>	<span class="token keyword">return</span> <span class="token function">oklab_to_linear_srgb</span><span class="token punctuation">(</span><span class="token punctuation">{</span> L_clipped<span class="token punctuation">,</span> C_clipped <span class="token operator">*</span> a_<span class="token punctuation">,</span> C_clipped <span class="token operator">*</span> b_ <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>RGB <span class="token function">gamut_clip_adaptive_L0_0_5</span><span class="token punctuation">(</span>RGB rgb<span class="token punctuation">,</span> <span class="token keyword">float</span> alpha <span class="token operator">=</span> <span class="token number">0.05f</span><span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>	<span class="token keyword">if</span> <span class="token punctuation">(</span>rgb<span class="token punctuation">.</span>r <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>g <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>b <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>r <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>g <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>b <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><br>		<span class="token keyword">return</span> rgb<span class="token punctuation">;</span><br><br>	Lab lab <span class="token operator">=</span> <span class="token function">linear_srgb_to_oklab</span><span class="token punctuation">(</span>rgb<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> L <span class="token operator">=</span> lab<span class="token punctuation">.</span>L<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> eps <span class="token operator">=</span> <span class="token number">0.00001f</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> C <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>eps<span class="token punctuation">,</span> <span class="token function">sqrtf</span><span class="token punctuation">(</span>lab<span class="token punctuation">.</span>a <span class="token operator">*</span> lab<span class="token punctuation">.</span>a <span class="token operator">+</span> lab<span class="token punctuation">.</span>b <span class="token operator">*</span> lab<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> a_ <span class="token operator">=</span> lab<span class="token punctuation">.</span>a <span class="token operator">/</span> C<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> b_ <span class="token operator">=</span> lab<span class="token punctuation">.</span>b <span class="token operator">/</span> C<span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> Ld <span class="token operator">=</span> L <span class="token operator">-</span> <span class="token number">0.5f</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> e1 <span class="token operator">=</span> <span class="token number">0.5f</span> <span class="token operator">+</span> <span class="token function">fabs</span><span class="token punctuation">(</span>Ld<span class="token punctuation">)</span> <span class="token operator">+</span> alpha <span class="token operator">*</span> C<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> L0 <span class="token operator">=</span> <span class="token number">0.5f</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1.f</span> <span class="token operator">+</span> <span class="token function">sgn</span><span class="token punctuation">(</span>Ld<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>e1 <span class="token operator">-</span> <span class="token function">sqrtf</span><span class="token punctuation">(</span>e1<span class="token operator">*</span>e1 <span class="token operator">-</span> <span class="token number">2.f</span> <span class="token operator">*</span><span class="token function">fabs</span><span class="token punctuation">(</span>Ld<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> t <span class="token operator">=</span> <span class="token function">find_gamut_intersection</span><span class="token punctuation">(</span>a_<span class="token punctuation">,</span> b_<span class="token punctuation">,</span> L<span class="token punctuation">,</span> C<span class="token punctuation">,</span> L0<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> L_clipped <span class="token operator">=</span> L0 <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.f</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">+</span> t <span class="token operator">*</span> L<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> C_clipped <span class="token operator">=</span> t <span class="token operator">*</span> C<span class="token punctuation">;</span><br><br>	<span class="token keyword">return</span> <span class="token function">oklab_to_linear_srgb</span><span class="token punctuation">(</span><span class="token punctuation">{</span> L_clipped<span class="token punctuation">,</span> C_clipped <span class="token operator">*</span> a_<span class="token punctuation">,</span> C_clipped <span class="token operator">*</span> b_ <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>RGB <span class="token function">gamut_clip_adaptive_L0_L_cusp</span><span class="token punctuation">(</span>RGB rgb<span class="token punctuation">,</span> <span class="token keyword">float</span> alpha <span class="token operator">=</span> <span class="token number">0.05f</span><span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>	<span class="token keyword">if</span> <span class="token punctuation">(</span>rgb<span class="token punctuation">.</span>r <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>g <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>b <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>r <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>g <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> rgb<span class="token punctuation">.</span>b <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><br>		<span class="token keyword">return</span> rgb<span class="token punctuation">;</span><br><br>	Lab lab <span class="token operator">=</span> <span class="token function">linear_srgb_to_oklab</span><span class="token punctuation">(</span>rgb<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> L <span class="token operator">=</span> lab<span class="token punctuation">.</span>L<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> eps <span class="token operator">=</span> <span class="token number">0.00001f</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> C <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>eps<span class="token punctuation">,</span> <span class="token function">sqrtf</span><span class="token punctuation">(</span>lab<span class="token punctuation">.</span>a <span class="token operator">*</span> lab<span class="token punctuation">.</span>a <span class="token operator">+</span> lab<span class="token punctuation">.</span>b <span class="token operator">*</span> lab<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> a_ <span class="token operator">=</span> lab<span class="token punctuation">.</span>a <span class="token operator">/</span> C<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> b_ <span class="token operator">=</span> lab<span class="token punctuation">.</span>b <span class="token operator">/</span> C<span class="token punctuation">;</span><br><br>	<span class="token comment">// The cusp is computed here and in find_gamut_intersection, an optimized solution would only compute it once.</span><br>	LC cusp <span class="token operator">=</span> <span class="token function">find_cusp</span><span class="token punctuation">(</span>a_<span class="token punctuation">,</span> b_<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> Ld <span class="token operator">=</span> L <span class="token operator">-</span> cusp<span class="token punctuation">.</span>L<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> k <span class="token operator">=</span> <span class="token number">2.f</span> <span class="token operator">*</span> <span class="token punctuation">(</span>Ld <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">1.f</span> <span class="token operator">-</span> cusp<span class="token punctuation">.</span>L <span class="token operator">:</span> cusp<span class="token punctuation">.</span>L<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> e1 <span class="token operator">=</span> <span class="token number">0.5f</span><span class="token operator">*</span>k <span class="token operator">+</span> <span class="token function">fabs</span><span class="token punctuation">(</span>Ld<span class="token punctuation">)</span> <span class="token operator">+</span> alpha <span class="token operator">*</span> C<span class="token operator">/</span>k<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> L0 <span class="token operator">=</span> cusp<span class="token punctuation">.</span>L <span class="token operator">+</span> <span class="token number">0.5f</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token function">sgn</span><span class="token punctuation">(</span>Ld<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>e1 <span class="token operator">-</span> <span class="token function">sqrtf</span><span class="token punctuation">(</span>e1 <span class="token operator">*</span> e1 <span class="token operator">-</span> <span class="token number">2.f</span> <span class="token operator">*</span> k <span class="token operator">*</span> <span class="token function">fabs</span><span class="token punctuation">(</span>Ld<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">float</span> t <span class="token operator">=</span> <span class="token function">find_gamut_intersection</span><span class="token punctuation">(</span>a_<span class="token punctuation">,</span> b_<span class="token punctuation">,</span> L<span class="token punctuation">,</span> C<span class="token punctuation">,</span> L0<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">float</span> L_clipped <span class="token operator">=</span> L0 <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.f</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">+</span> t <span class="token operator">*</span> L<span class="token punctuation">;</span><br>	<span class="token keyword">float</span> C_clipped <span class="token operator">=</span> t <span class="token operator">*</span> C<span class="token punctuation">;</span><br><br>	<span class="token keyword">return</span> <span class="token function">oklab_to_linear_srgb</span><span class="token punctuation">(</span><span class="token punctuation">{</span> L_clipped<span class="token punctuation">,</span> C_clipped <span class="token operator">*</span> a_<span class="token punctuation">,</span> C_clipped <span class="token operator">*</span> b_ <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br></code></pre><hr><p>If you liked this article, it would be great if you considered sharing it:</p><div class="buttons"><a href="https://twitter.com/intent/tweet/?text=sRGB%20gamut%20clipping&amp;url=https%3A%2F%2Fbottosson.github.io%2Fposts%2Fgamutclipping%2F" class="is-small button resp-sharing-button--twitter" rel="noopener" target="_blank" aria-label="Share on Twitter"><span class="icon resp-sharing-button__icon resp-sharing-button__icon--solid"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"></path></svg> </span></a><a href="mailto:?subject=sRGB%20gamut%20clipping&amp;body=https%3A%2F%2Fbottosson.github.io%2Fposts%2Fgamutclipping%2F" class="is-small button resp-sharing-button--email" rel="noopener" target="_self" aria-label="Share by E-Mail"><span class="icon resp-sharing-button__icon resp-sharing-button__icon--solid"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"></path></svg> </span></a><a href="https://reddit.com/submit/?url=https%3A%2F%2Fbottosson.github.io%2Fposts%2Fgamutclipping%2F&amp;resubmit=true&amp;title=sRGB%20gamut%20clipping" class="is-small button resp-sharing-button--reddit" rel="noopener" target="_blank" aria-label="Share on Reddit"><span class="icon resp-sharing-button__icon resp-sharing-button__icon--solid"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"></path></svg> </span></a><a href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fbottosson.github.io%2Fposts%2Fgamutclipping%2F&amp;t=sRGB%20gamut%20clipping" class="is-small button resp-sharing-button--hackernews" rel="noopener" target="_blank" aria-label="Share on Hacker News"><span class="icon resp-sharing-button__icon resp-sharing-button__icon--solid"><svg viewBox="0 0 140 140" xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path d="M60.94 82.314L17 0h20.08l25.85 52.093c.397.927.86 1.888 1.39 2.883.53.994.995 2.02 1.393 3.08.265.4.463.764.596 1.095.13.334.262.63.395.898.662 1.325 1.26 2.618 1.79 3.877.53 1.26.993 2.42 1.39 3.48 1.06-2.254 2.22-4.673 3.48-7.258 1.26-2.585 2.552-5.27 3.877-8.052L103.49 0h18.69L77.84 83.308v53.087h-16.9v-54.08z" fill-rule="evenodd"></path></svg> </span></a><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fbottosson.github.io%2Fposts%2Fgamutclipping%2F&amp;title=sRGB%20gamut%20clipping&amp;source=https%3A%2F%2Fbottosson.github.io%2Fposts%2Fgamutclipping%2F" class="is-small button resp-sharing-button--linkedin" rel="noopener" target="_blank" aria-label="Share on LinkedIn"><span class="icon resp-sharing-button__icon resp-sharing-button__icon--solid"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"></path></svg> </span></a><a href="https://facebook.com/sharer/sharer.php?u=https%3A%2F%2Fbottosson.github.io%2Fposts%2Fgamutclipping%2F" class="is-small button resp-sharing-button--facebook" rel="noopener" target="_blank" aria-label="Share on Facebook"><span class="icon resp-sharing-button__icon resp-sharing-button__icon--solid"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"></path></svg></span></a></div><p></p><p>For discussions and feedback, <a href="https://twitter.com/bjornornorn" rel="noopener" target="_blank">ping me on Twitter.</a></p><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"sRGB gamut clipping","image":["https://bottosson.github.io/img/gamutclipping/flowers/original.jpg","https://bottosson.github.io/img/gamutclipping/flowers/clipped_rgb.jpg","https://bottosson.github.io/img/gamutclipping/hueslices/0.png","https://bottosson.github.io/img/gamutclipping/hueslices/30.png","https://bottosson.github.io/img/gamutclipping/hueslices/60.png","https://bottosson.github.io/img/gamutclipping/hueslices/90.png","https://bottosson.github.io/img/gamutclipping/hueslices/120.png","https://bottosson.github.io/img/gamutclipping/hueslices/150.png","https://bottosson.github.io/img/gamutclipping/hueslices/180.png","https://bottosson.github.io/img/gamutclipping/hueslices/210.png","https://bottosson.github.io/img/gamutclipping/hueslices/240.png","https://bottosson.github.io/img/gamutclipping/hueslices/270.png","https://bottosson.github.io/img/gamutclipping/hueslices/300.png","https://bottosson.github.io/img/gamutclipping/hueslices/330.png","https://bottosson.github.io/img/gamutclipping/redslices/clipped_chroma.png","https://bottosson.github.io/img/gamutclipping/yellowgreenslices/clipped_chroma.png","https://bottosson.github.io/img/gamutclipping/flowers/clipped_chroma.jpg","https://bottosson.github.io/img/gamutclipping/redslices/sp_middle_grey.png","https://bottosson.github.io/img/gamutclipping/yellowgreenslices/sp_middle_grey.png","https://bottosson.github.io/img/gamutclipping/flowers/sp_middle_grey.jpg","https://bottosson.github.io/img/gamutclipping/redslices/sp_L_cusp.png","https://bottosson.github.io/img/gamutclipping/yellowgreenslices/sp_L_cusp.png","https://bottosson.github.io/img/gamutclipping/flowers/sp_L_cusp.jpg","https://bottosson.github.io/img/gamutclipping/redslices/adaptive_middle_grey_0_05.png","https://bottosson.github.io/img/gamutclipping/yellowgreenslices/adaptive_middle_grey_0_05.png","https://bottosson.github.io/img/gamutclipping/flowers/adaptive_middle_grey_0_05.jpg","https://bottosson.github.io/img/gamutclipping/redslices/adaptive_middle_grey_0_50.png","https://bottosson.github.io/img/gamutclipping/yellowgreenslices/adaptive_middle_grey_0_50.png","https://bottosson.github.io/img/gamutclipping/flowers/adaptive_middle_grey_0_50.jpg","https://bottosson.github.io/img/gamutclipping/redslices/adaptive_middle_grey_5_00.png","https://bottosson.github.io/img/gamutclipping/yellowgreenslices/adaptive_middle_grey_5_00.png","https://bottosson.github.io/img/gamutclipping/flowers/adaptive_middle_grey_5_00.jpg","https://bottosson.github.io/img/gamutclipping/redslices/adaptive_L_cusp_0_05.png","https://bottosson.github.io/img/gamutclipping/yellowgreenslices/adaptive_L_cusp_0_05.png","https://bottosson.github.io/img/gamutclipping/flowers/adaptive_L_cusp_0_05.jpg","https://bottosson.github.io/img/gamutclipping/redslices/adaptive_L_cusp_0_50.png","https://bottosson.github.io/img/gamutclipping/yellowgreenslices/adaptive_L_cusp_0_50.png","https://bottosson.github.io/img/gamutclipping/flowers/adaptive_L_cusp_0_50.jpg","https://bottosson.github.io/img/gamutclipping/redslices/adaptive_L_cusp_5_00.png","https://bottosson.github.io/img/gamutclipping/yellowgreenslices/adaptive_L_cusp_5_00.png","https://bottosson.github.io/img/gamutclipping/flowers/adaptive_L_cusp_5_00.jpg","https://bottosson.github.io/img/gamutclipping/flowers/original.jpg","https://bottosson.github.io/img/gamutclipping/flowers/out_of_gamut.jpg","https://bottosson.github.io/img/gamutclipping/flowers/clipped_rgb.jpg","https://bottosson.github.io/img/gamutclipping/flowers/clipped_chroma.jpg","https://bottosson.github.io/img/gamutclipping/flowers/sp_middle_grey.jpg","https://bottosson.github.io/img/gamutclipping/flowers/sp_L_cusp.jpg","https://bottosson.github.io/img/gamutclipping/flowers/adaptive_middle_grey_0_05.jpg","https://bottosson.github.io/img/gamutclipping/flowers/adaptive_middle_grey_0_50.jpg","https://bottosson.github.io/img/gamutclipping/flowers/adaptive_middle_grey_5_00.jpg","https://bottosson.github.io/img/gamutclipping/flowers/adaptive_L_cusp_0_05.jpg","https://bottosson.github.io/img/gamutclipping/flowers/adaptive_L_cusp_0_50.jpg","https://bottosson.github.io/img/gamutclipping/flowers/adaptive_L_cusp_5_00.jpg","https://bottosson.github.io/img/gamutclipping/lamp/original.jpg","https://bottosson.github.io/img/gamutclipping/lamp/out_of_gamut.jpg","https://bottosson.github.io/img/gamutclipping/lamp/clipped_rgb.jpg","https://bottosson.github.io/img/gamutclipping/lamp/clipped_chroma.jpg","https://bottosson.github.io/img/gamutclipping/lamp/sp_middle_grey.jpg","https://bottosson.github.io/img/gamutclipping/lamp/sp_L_cusp.jpg","https://bottosson.github.io/img/gamutclipping/lamp/adaptive_middle_grey_0_05.jpg","https://bottosson.github.io/img/gamutclipping/lamp/adaptive_middle_grey_0_50.jpg","https://bottosson.github.io/img/gamutclipping/lamp/adaptive_middle_grey_5_00.jpg","https://bottosson.github.io/img/gamutclipping/lamp/adaptive_L_cusp_0_05.jpg","https://bottosson.github.io/img/gamutclipping/lamp/adaptive_L_cusp_0_50.jpg","https://bottosson.github.io/img/gamutclipping/lamp/adaptive_L_cusp_5_00.jpg","https://bottosson.github.io/img/gamutclipping/tulip/original.jpg","https://bottosson.github.io/img/gamutclipping/tulip/out_of_gamut.jpg","https://bottosson.github.io/img/gamutclipping/tulip/clipped_rgb.jpg","https://bottosson.github.io/img/gamutclipping/tulip/clipped_chroma.jpg","https://bottosson.github.io/img/gamutclipping/tulip/sp_middle_grey.jpg","https://bottosson.github.io/img/gamutclipping/tulip/sp_L_cusp.jpg","https://bottosson.github.io/img/gamutclipping/tulip/adaptive_middle_grey_0_05.jpg","https://bottosson.github.io/img/gamutclipping/tulip/adaptive_middle_grey_0_50.jpg","https://bottosson.github.io/img/gamutclipping/tulip/adaptive_middle_grey_5_00.jpg","https://bottosson.github.io/img/gamutclipping/tulip/adaptive_L_cusp_0_05.jpg","https://bottosson.github.io/img/gamutclipping/tulip/adaptive_L_cusp_0_50.jpg","https://bottosson.github.io/img/gamutclipping/tulip/adaptive_L_cusp_5_00.jpg","https://bottosson.github.io/img/gamutclipping/boat/original.jpg","https://bottosson.github.io/img/gamutclipping/boat/out_of_gamut.jpg","https://bottosson.github.io/img/gamutclipping/boat/clipped_rgb.jpg","https://bottosson.github.io/img/gamutclipping/boat/clipped_chroma.jpg","https://bottosson.github.io/img/gamutclipping/boat/sp_middle_grey.jpg","https://bottosson.github.io/img/gamutclipping/boat/sp_L_cusp.jpg","https://bottosson.github.io/img/gamutclipping/boat/adaptive_middle_grey_0_05.jpg","https://bottosson.github.io/img/gamutclipping/boat/adaptive_middle_grey_0_50.jpg","https://bottosson.github.io/img/gamutclipping/boat/adaptive_middle_grey_5_00.jpg","https://bottosson.github.io/img/gamutclipping/boat/adaptive_L_cusp_0_05.jpg","https://bottosson.github.io/img/gamutclipping/boat/adaptive_L_cusp_0_50.jpg","https://bottosson.github.io/img/gamutclipping/boat/adaptive_L_cusp_5_00.jpg"],"author":"Björn Ottosson","genre":"","publisher":{"@type":"Organization","name":"Björn Ottosson","logo":{"@type":"ImageObject","url":"/img/favicon/favicon-192x192.png?hash=98293e6f87"}},"url":"https://bottosson.github.io/posts/gamutclipping/","mainEntityOfPage":"https://bottosson.github.io/posts/gamutclipping/","datePublished":"2021-01-25","dateModified":"2021-01-25","description":"sRGB gamut clipping When doing image processing, rendering or converting between RGB color spaces, it is easy to end up with RGB values..."}</script><p>Published <time datetime="2021-01-25">25 Jan 2021</time></p></div></article></main></body></html>